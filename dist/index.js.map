{"version":3,"file":"index.js","sources":["../src/types/public-types.ts","../src/helpers/date-helper.ts","../src/components/task-list/task-list-header.tsx","../src/components/task-list/task-list-table.tsx","../src/components/other/tooltip.tsx","../src/components/other/vertical-scroll.tsx","../src/components/task-list/task-list.tsx","../src/components/grid/grid-body.tsx","../src/components/grid/grid.tsx","../src/components/calendar/top-part-of-calendar.tsx","../src/components/calendar/calendar.tsx","../node_modules/babel-plugin-transform-async-to-promises/helpers.mjs","../src/components/other/arrow.tsx","../src/helpers/bar-helper.ts","../src/helpers/other-helper.ts","../src/components/task-item/bar/bar-display.tsx","../src/components/task-item/bar/bar-date-handle.tsx","../src/components/task-item/bar/bar-progress-handle.tsx","../src/components/task-item/bar/bar.tsx","../src/components/task-item/bar/bar-small.tsx","../src/components/task-item/milestone/milestone.tsx","../src/components/task-item/project/project.tsx","../src/components/task-item/task-item.tsx","../src/components/gantt/task-gantt-content.tsx","../src/components/gantt/task-gantt.tsx","../src/components/other/horizontal-scroll.tsx","../src/components/gantt/gantt.tsx"],"sourcesContent":["export enum ViewMode {\r\n  Hour = \"Hour\",\r\n  QuarterDay = \"Quarter Day\",\r\n  HalfDay = \"Half Day\",\r\n  Day = \"Day\",\r\n  /** ISO-8601 week */\r\n  Week = \"Week\",\r\n  Month = \"Month\",\r\n  QuarterYear = \"QuarterYear\",\r\n  Year = \"Year\",\r\n}\r\nexport type TaskType = \"task\" | \"milestone\" | \"project\";\r\nexport interface Task {\r\n  id: string;\r\n  type: TaskType;\r\n  name: string;\r\n  start: Date;\r\n  end: Date;\r\n  /**\r\n   * From 0 to 100\r\n   */\r\n  progress: number;\r\n  styles?: {\r\n    backgroundColor?: string;\r\n    backgroundSelectedColor?: string;\r\n    progressColor?: string;\r\n    progressSelectedColor?: string;\r\n  };\r\n  isDisabled?: boolean;\r\n  project?: string;\r\n  dependencies?: string[];\r\n  hideChildren?: boolean;\r\n  displayOrder?: number;\r\n}\r\n\r\nexport interface EventOption {\r\n  /**\r\n   * Time step value for date changes.\r\n   */\r\n  timeStep?: number;\r\n  /**\r\n   * Invokes on bar select on unselect.\r\n   */\r\n  onSelect?: (task: Task, isSelected: boolean) => void;\r\n  /**\r\n   * Invokes on bar double click.\r\n   */\r\n  onDoubleClick?: (task: Task) => void;\r\n  /**\r\n   * Invokes on bar click.\r\n   */\r\n  onClick?: (task: Task) => void;\r\n  /**\r\n   * Invokes on end and start time change. Chart undoes operation if method return false or error.\r\n   */\r\n  onDateChange?: (\r\n    task: Task,\r\n    children: Task[]\r\n  ) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on progress change. Chart undoes operation if method return false or error.\r\n   */\r\n  onProgressChange?: (\r\n    task: Task,\r\n    children: Task[]\r\n  ) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on delete selected task. Chart undoes operation if method return false or error.\r\n   */\r\n  onDelete?: (task: Task) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on expander on task list\r\n   */\r\n  onExpanderClick?: (task: Task) => void;\r\n}\r\n\r\nexport interface DisplayOption {\r\n  viewMode?: ViewMode;\r\n  viewDate?: Date;\r\n  preStepsCount?: number;\r\n  /**\r\n   * Specifies the month name language. Able formats: ISO 639-2, Java Locale\r\n   */\r\n  locale?: string;\r\n  rtl?: boolean;\r\n}\r\n\r\nexport interface StylingOption {\r\n  headerHeight?: number;\r\n  columnWidth?: number;\r\n  listCellWidth?: string;\r\n  rowHeight?: number;\r\n  ganttHeight?: number;\r\n  barCornerRadius?: number;\r\n  handleWidth?: number;\r\n  fontFamily?: string;\r\n  fontSize?: string;\r\n  /**\r\n   * How many of row width can be taken by task.\r\n   * From 0 to 100\r\n   */\r\n  barFill?: number;\r\n  barProgressColor?: string;\r\n  barProgressSelectedColor?: string;\r\n  barBackgroundColor?: string;\r\n  barBackgroundSelectedColor?: string;\r\n  projectProgressColor?: string;\r\n  projectProgressSelectedColor?: string;\r\n  projectBackgroundColor?: string;\r\n  projectBackgroundSelectedColor?: string;\r\n  milestoneBackgroundColor?: string;\r\n  milestoneBackgroundSelectedColor?: string;\r\n  arrowColor?: string;\r\n  arrowIndent?: number;\r\n  todayColor?: string;\r\n  TooltipContent?: React.FC<{\r\n    task: Task;\r\n    fontSize: string;\r\n    fontFamily: string;\r\n  }>;\r\n  TaskListHeader?: React.FC<{\r\n    headerHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n  }>;\r\n  TaskListTable?: React.FC<{\r\n    rowHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n    locale: string;\r\n    tasks: Task[];\r\n    selectedTaskId: string;\r\n    /**\r\n     * Sets selected task by id\r\n     */\r\n    setSelectedTask: (taskId: string) => void;\r\n    onExpanderClick: (task: Task) => void;\r\n  }>;\r\n}\r\n\r\nexport interface GanttProps extends EventOption, DisplayOption, StylingOption {\r\n  tasks: Task[];\r\n  rowCountOverride?: number;\r\n}\r\n","import { Task, ViewMode } from \"../types/public-types\";\r\nimport DateTimeFormatOptions = Intl.DateTimeFormatOptions;\r\nimport DateTimeFormat = Intl.DateTimeFormat;\r\n\r\ntype DateHelperScales =\r\n  | \"year\"\r\n  | \"month\"\r\n  | \"day\"\r\n  | \"hour\"\r\n  | \"minute\"\r\n  | \"second\"\r\n  | \"millisecond\";\r\n\r\nconst intlDTCache: Record<string, DateTimeFormat> = {};\r\nexport const getCachedDateTimeFormat = (\r\n  locString: string | string[],\r\n  opts: DateTimeFormatOptions = {}\r\n): DateTimeFormat => {\r\n  const key = JSON.stringify([locString, opts]);\r\n  let dtf = intlDTCache[key];\r\n  if (!dtf) {\r\n    dtf = new Intl.DateTimeFormat(locString, opts);\r\n    intlDTCache[key] = dtf;\r\n  }\r\n  return dtf;\r\n};\r\n\r\nexport const addToDate = (\r\n  date: Date,\r\n  quantity: number,\r\n  scale: DateHelperScales\r\n) => {\r\n  const newDate = new Date(\r\n    date.getFullYear() + (scale === \"year\" ? quantity : 0),\r\n    date.getMonth() + (scale === \"month\" ? quantity : 0),\r\n    date.getDate() + (scale === \"day\" ? quantity : 0),\r\n    date.getHours() + (scale === \"hour\" ? quantity : 0),\r\n    date.getMinutes() + (scale === \"minute\" ? quantity : 0),\r\n    date.getSeconds() + (scale === \"second\" ? quantity : 0),\r\n    date.getMilliseconds() + (scale === \"millisecond\" ? quantity : 0)\r\n  );\r\n  return newDate;\r\n};\r\n\r\nexport const startOfDate = (date: Date, scale: DateHelperScales) => {\r\n  const scores = [\r\n    \"millisecond\",\r\n    \"second\",\r\n    \"minute\",\r\n    \"hour\",\r\n    \"day\",\r\n    \"month\",\r\n    \"year\",\r\n  ];\r\n\r\n  const shouldReset = (_scale: DateHelperScales) => {\r\n    const maxScore = scores.indexOf(scale);\r\n    return scores.indexOf(_scale) <= maxScore;\r\n  };\r\n  const newDate = new Date(\r\n    date.getFullYear(),\r\n    shouldReset(\"year\") ? 0 : date.getMonth(),\r\n    shouldReset(\"month\") ? 1 : date.getDate(),\r\n    shouldReset(\"day\") ? 0 : date.getHours(),\r\n    shouldReset(\"hour\") ? 0 : date.getMinutes(),\r\n    shouldReset(\"minute\") ? 0 : date.getSeconds(),\r\n    shouldReset(\"second\") ? 0 : date.getMilliseconds()\r\n  );\r\n  return newDate;\r\n};\r\n\r\nexport const ganttDateRange = (\r\n  tasks: Task[],\r\n  viewMode: ViewMode,\r\n  preStepsCount: number\r\n) => {\r\n  let newStartDate: Date = tasks[0].start;\r\n  let newEndDate: Date = tasks[0].start;\r\n  for (const task of tasks) {\r\n    if (task.start < newStartDate) {\r\n      newStartDate = task.start;\r\n    }\r\n    if (task.end > newEndDate) {\r\n      newEndDate = task.end;\r\n    }\r\n  }\r\n  switch (viewMode) {\r\n    case ViewMode.Year:\r\n      newStartDate = addToDate(newStartDate, -1, \"year\");\r\n      newStartDate = startOfDate(newStartDate, \"year\");\r\n      newEndDate = addToDate(newEndDate, 1, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    case ViewMode.QuarterYear:\r\n      newStartDate = addToDate(newStartDate, -3, \"month\");\r\n      newStartDate = startOfDate(newStartDate, \"month\");\r\n      newEndDate = addToDate(newEndDate, 3, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    case ViewMode.Month:\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"month\");\r\n      newStartDate = startOfDate(newStartDate, \"month\");\r\n      newEndDate = addToDate(newEndDate, 1, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    case ViewMode.Week:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(\r\n        getMonday(newStartDate),\r\n        -7 * preStepsCount,\r\n        \"day\"\r\n      );\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 1.5, \"month\");\r\n      break;\r\n    case ViewMode.Day:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 1, \"day\");\r\n      break;\r\n    case ViewMode.QuarterDay:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 66, \"hour\"); // 24(1 day)*3 - 6\r\n      break;\r\n    case ViewMode.HalfDay:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 108, \"hour\"); // 24(1 day)*5 - 12\r\n      break;\r\n    case ViewMode.Hour:\r\n      newStartDate = startOfDate(newStartDate, \"hour\");\r\n      newStartDate = addToDate(newStartDate, -1 * preStepsCount, \"hour\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newEndDate = addToDate(newEndDate, 1, \"day\");\r\n      break;\r\n  }\r\n  return [newStartDate, newEndDate];\r\n};\r\n\r\nexport const seedDates = (\r\n  startDate: Date,\r\n  endDate: Date,\r\n  viewMode: ViewMode\r\n) => {\r\n  let currentDate: Date = new Date(startDate);\r\n  const dates: Date[] = [currentDate];\r\n  while (currentDate < endDate) {\r\n    switch (viewMode) {\r\n      case ViewMode.Year:\r\n        currentDate = addToDate(currentDate, 1, \"year\");\r\n        break;\r\n      case ViewMode.QuarterYear:\r\n        currentDate = addToDate(currentDate, 3, \"month\");\r\n        break;\r\n      case ViewMode.Month:\r\n        currentDate = addToDate(currentDate, 1, \"month\");\r\n        break;\r\n      case ViewMode.Week:\r\n        currentDate = addToDate(currentDate, 7, \"day\");\r\n        break;\r\n      case ViewMode.Day:\r\n        currentDate = addToDate(currentDate, 1, \"day\");\r\n        break;\r\n      case ViewMode.HalfDay:\r\n        currentDate = addToDate(currentDate, 12, \"hour\");\r\n        break;\r\n      case ViewMode.QuarterDay:\r\n        currentDate = addToDate(currentDate, 6, \"hour\");\r\n        break;\r\n      case ViewMode.Hour:\r\n        currentDate = addToDate(currentDate, 1, \"hour\");\r\n        break;\r\n    }\r\n    dates.push(currentDate);\r\n  }\r\n  return dates;\r\n};\r\n\r\nexport const getLocaleMonth = (date: Date, locale: string) => {\r\n  let bottomValue = getCachedDateTimeFormat(locale, {\r\n    month: \"long\",\r\n  }).format(date);\r\n  bottomValue = bottomValue.replace(\r\n    bottomValue[0],\r\n    bottomValue[0].toLocaleUpperCase()\r\n  );\r\n  return bottomValue;\r\n};\r\n\r\nexport const getLocalDayOfWeek = (\r\n  date: Date,\r\n  locale: string,\r\n  format?: \"long\" | \"short\" | \"narrow\" | undefined\r\n) => {\r\n  let bottomValue = getCachedDateTimeFormat(locale, {\r\n    weekday: format,\r\n  }).format(date);\r\n  bottomValue = bottomValue.replace(\r\n    bottomValue[0],\r\n    bottomValue[0].toLocaleUpperCase()\r\n  );\r\n  return bottomValue;\r\n};\r\n\r\n/**\r\n * Returns monday of current week\r\n * @param date date for modify\r\n */\r\nconst getMonday = (date: Date) => {\r\n  const day = date.getDay();\r\n  const diff = date.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday\r\n  return new Date(date.setDate(diff));\r\n};\r\n\r\nexport const getWeekNumberISO8601 = (date: Date) => {\r\n  const tmpDate = new Date(date.valueOf());\r\n  const dayNumber = (tmpDate.getDay() + 6) % 7;\r\n  tmpDate.setDate(tmpDate.getDate() - dayNumber + 3);\r\n  const firstThursday = tmpDate.valueOf();\r\n  tmpDate.setMonth(0, 1);\r\n  if (tmpDate.getDay() !== 4) {\r\n    tmpDate.setMonth(0, 1 + ((4 - tmpDate.getDay() + 7) % 7));\r\n  }\r\n  const weekNumber = (\r\n    1 + Math.ceil((firstThursday - tmpDate.valueOf()) / 604800000)\r\n  ).toString();\r\n\r\n  if (weekNumber.length === 1) {\r\n    return `0${weekNumber}`;\r\n  } else {\r\n    return weekNumber;\r\n  }\r\n};\r\n\r\nexport const getDaysInMonth = (month: number, year: number) => {\r\n  return new Date(year, month + 1, 0).getDate();\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./task-list-header.module.css\";\r\n\r\nexport const TaskListHeaderDefault: React.FC<{\r\n  headerHeight: number;\r\n  rowWidth: string;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n}> = ({ headerHeight, fontFamily, fontSize, rowWidth }) => {\r\n  return (\r\n    <div\r\n      className={styles.ganttTable}\r\n      style={{\r\n        fontFamily: fontFamily,\r\n        fontSize: fontSize,\r\n      }}\r\n    >\r\n      <div\r\n        className={styles.ganttTable_Header}\r\n        style={{\r\n          height: headerHeight - 2,\r\n        }}\r\n      >\r\n        <div\r\n          className={styles.ganttTable_HeaderItem}\r\n          style={{\r\n            minWidth: rowWidth,\r\n          }}\r\n        >\r\n          &nbsp;Name\r\n        </div>\r\n        <div\r\n          className={styles.ganttTable_HeaderSeparator}\r\n          style={{\r\n            height: headerHeight * 0.5,\r\n            marginTop: headerHeight * 0.2,\r\n          }}\r\n        />\r\n        <div\r\n          className={styles.ganttTable_HeaderItem}\r\n          style={{\r\n            minWidth: rowWidth,\r\n          }}\r\n        >\r\n          &nbsp;From\r\n        </div>\r\n        <div\r\n          className={styles.ganttTable_HeaderSeparator}\r\n          style={{\r\n            height: headerHeight * 0.5,\r\n            marginTop: headerHeight * 0.25,\r\n          }}\r\n        />\r\n        <div\r\n          className={styles.ganttTable_HeaderItem}\r\n          style={{\r\n            minWidth: rowWidth,\r\n          }}\r\n        >\r\n          &nbsp;To\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useMemo } from \"react\";\r\nimport styles from \"./task-list-table.module.css\";\r\nimport { Task } from \"../../types/public-types\";\r\n\r\nconst localeDateStringCache: Record<string, string> = {};\r\nconst toLocaleDateStringFactory =\r\n  (locale: string) =>\r\n  (date: Date, dateTimeOptions: Intl.DateTimeFormatOptions) => {\r\n    const key = JSON.stringify([locale, date.getTime(), dateTimeOptions]);\r\n    let lds = localeDateStringCache[key];\r\n    if (!lds) {\r\n      lds = date.toLocaleDateString(locale, dateTimeOptions);\r\n      localeDateStringCache[key] = lds;\r\n    }\r\n    return lds;\r\n  };\r\n\r\nconst dateTimeOptions: Intl.DateTimeFormatOptions = {\r\n  weekday: \"short\",\r\n  year: \"numeric\",\r\n  month: \"long\",\r\n  day: \"numeric\",\r\n};\r\n\r\nexport const TaskListTableDefault: React.FC<{\r\n  rowHeight: number;\r\n  rowWidth: string;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n  locale: string;\r\n  tasks: Task[];\r\n  selectedTaskId: string;\r\n  setSelectedTask: (taskId: string) => void;\r\n  onExpanderClick: (task: Task) => void;\r\n}> = ({\r\n  rowHeight,\r\n  rowWidth,\r\n  tasks,\r\n  fontFamily,\r\n  fontSize,\r\n  locale,\r\n  onExpanderClick,\r\n}) => {\r\n  const toLocaleDateString = useMemo(\r\n    () => toLocaleDateStringFactory(locale),\r\n    [locale]\r\n  );\r\n\r\n  const groups = tasks.reduce((acc, t) => {\r\n    const key = t.name ?? \"\";\r\n    if (!acc[key]) acc[key] = [];\r\n    acc[key].push(t);\r\n    return acc;\r\n  }, {} as Record<string, Task[]>);\r\n\r\n  return (\r\n    <div\r\n      className={styles.taskListWrapper}\r\n      style={{\r\n        fontFamily: fontFamily,\r\n        fontSize: fontSize,\r\n      }}\r\n    >\r\n      {Object.entries(groups).map(([name, employeeTasks]) => {\r\n        const main = employeeTasks[0];\r\n\r\n        let expanderSymbol = \"\";\r\n        if (main.hideChildren === false) expanderSymbol = \"▼\";\r\n        else if (main.hideChildren === true) expanderSymbol = \"▶\";\r\n\r\n        return (\r\n          <div\r\n            key={name}\r\n            className={styles.taskListTableRow}\r\n            style={{ height: rowHeight }}\r\n          >\r\n            <div\r\n              className={styles.taskListCell}\r\n              style={{ minWidth: rowWidth, maxWidth: rowWidth }}\r\n              title={name}\r\n            >\r\n              <div className={styles.taskListNameWrapper}>\r\n                <div\r\n                  className={\r\n                    expanderSymbol\r\n                      ? styles.taskListExpander\r\n                      : styles.taskListEmptyExpander\r\n                  }\r\n                  onClick={() => onExpanderClick(main)}\r\n                >\r\n                  {expanderSymbol}\r\n                </div>\r\n                <div>{name}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div\r\n              className={styles.taskListCell}\r\n              style={{ minWidth: rowWidth, maxWidth: rowWidth }}\r\n            >\r\n              &nbsp;\r\n              {toLocaleDateString(\r\n                new Date(\r\n                  Math.min(...employeeTasks.map(t => t.start.getTime()))\r\n                ),\r\n                dateTimeOptions\r\n              )}\r\n            </div>\r\n\r\n            <div\r\n              className={styles.taskListCell}\r\n              style={{ minWidth: rowWidth, maxWidth: rowWidth }}\r\n            >\r\n              &nbsp;\r\n              {toLocaleDateString(\r\n                new Date(\r\n                  Math.max(...employeeTasks.map(t => t.end.getTime()))\r\n                ),\r\n                dateTimeOptions\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\nimport { Task } from \"../../types/public-types\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport styles from \"./tooltip.module.css\";\r\n\r\nexport type TooltipProps = {\r\n  task: BarTask;\r\n  arrowIndent: number;\r\n  rtl: boolean;\r\n  svgContainerHeight: number;\r\n  svgContainerWidth: number;\r\n  svgWidth: number;\r\n  headerHeight: number;\r\n  taskListWidth: number;\r\n  scrollX: number;\r\n  scrollY: number;\r\n  rowHeight: number;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n  TooltipContent: React.FC<{\r\n    task: Task;\r\n    fontSize: string;\r\n    fontFamily: string;\r\n  }>;\r\n};\r\nexport const Tooltip: React.FC<TooltipProps> = ({\r\n  task,\r\n  rowHeight,\r\n  rtl,\r\n  svgContainerHeight,\r\n  svgContainerWidth,\r\n  scrollX,\r\n  scrollY,\r\n  arrowIndent,\r\n  fontSize,\r\n  fontFamily,\r\n  headerHeight,\r\n  taskListWidth,\r\n  TooltipContent,\r\n}) => {\r\n  const tooltipRef = useRef<HTMLDivElement | null>(null);\r\n  const [relatedY, setRelatedY] = useState(0);\r\n  const [relatedX, setRelatedX] = useState(0);\r\n  useEffect(() => {\r\n    if (tooltipRef.current) {\r\n      const tooltipHeight = tooltipRef.current.offsetHeight * 1.1;\r\n      const tooltipWidth = tooltipRef.current.offsetWidth * 1.1;\r\n\r\n      let newRelatedY = task.index * rowHeight - scrollY + headerHeight;\r\n      let newRelatedX: number;\r\n      if (rtl) {\r\n        newRelatedX = task.x1 - arrowIndent * 1.5 - tooltipWidth - scrollX;\r\n        if (newRelatedX < 0) {\r\n          newRelatedX = task.x2 + arrowIndent * 1.5 - scrollX;\r\n        }\r\n        const tooltipLeftmostPoint = tooltipWidth + newRelatedX;\r\n        if (tooltipLeftmostPoint > svgContainerWidth) {\r\n          newRelatedX = svgContainerWidth - tooltipWidth;\r\n          newRelatedY += rowHeight;\r\n        }\r\n      } else {\r\n        newRelatedX = task.x2 + arrowIndent * 1.5 + taskListWidth - scrollX;\r\n        const tooltipLeftmostPoint = tooltipWidth + newRelatedX;\r\n        const fullChartWidth = taskListWidth + svgContainerWidth;\r\n        if (tooltipLeftmostPoint > fullChartWidth) {\r\n          newRelatedX =\r\n            task.x1 +\r\n            taskListWidth -\r\n            arrowIndent * 1.5 -\r\n            scrollX -\r\n            tooltipWidth;\r\n        }\r\n        if (newRelatedX < taskListWidth) {\r\n          newRelatedX = svgContainerWidth + taskListWidth - tooltipWidth;\r\n          newRelatedY += rowHeight;\r\n        }\r\n      }\r\n\r\n      const tooltipLowerPoint = tooltipHeight + newRelatedY - scrollY;\r\n      if (tooltipLowerPoint > svgContainerHeight - scrollY) {\r\n        newRelatedY = svgContainerHeight - tooltipHeight;\r\n      }\r\n      setRelatedY(newRelatedY);\r\n      setRelatedX(newRelatedX);\r\n    }\r\n  }, [\r\n    tooltipRef,\r\n    task,\r\n    arrowIndent,\r\n    scrollX,\r\n    scrollY,\r\n    headerHeight,\r\n    taskListWidth,\r\n    rowHeight,\r\n    svgContainerHeight,\r\n    svgContainerWidth,\r\n    rtl,\r\n  ]);\r\n\r\n  return (\r\n    <div\r\n      ref={tooltipRef}\r\n      className={\r\n        relatedX\r\n          ? styles.tooltipDetailsContainer\r\n          : styles.tooltipDetailsContainerHidden\r\n      }\r\n      style={{ left: relatedX, top: relatedY }}\r\n    >\r\n      <TooltipContent task={task} fontSize={fontSize} fontFamily={fontFamily} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const StandardTooltipContent: React.FC<{\r\n  task: Task;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n}> = ({ task, fontSize, fontFamily }) => {\r\n  const style = {\r\n    fontSize,\r\n    fontFamily,\r\n  };\r\n  return (\r\n    <div className={styles.tooltipDefaultContainer} style={style}>\r\n      <b style={{ fontSize: fontSize + 6 }}>{`${\r\n        task.name\r\n      }: ${task.start.getDate()}-${\r\n        task.start.getMonth() + 1\r\n      }-${task.start.getFullYear()} - ${task.end.getDate()}-${\r\n        task.end.getMonth() + 1\r\n      }-${task.end.getFullYear()}`}</b>\r\n      {task.end.getTime() - task.start.getTime() !== 0 && (\r\n        <p className={styles.tooltipDefaultContainerParagraph}>{`Duration: ${~~(\r\n          (task.end.getTime() - task.start.getTime()) /\r\n          (1000 * 60 * 60 * 24)\r\n        )} day(s)`}</p>\r\n      )}\r\n\r\n      <p className={styles.tooltipDefaultContainerParagraph}>\r\n        {!!task.progress && `Progress: ${task.progress} %`}\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SyntheticEvent, useRef, useEffect } from \"react\";\r\nimport styles from \"./vertical-scroll.module.css\";\r\n\r\nexport const VerticalScroll: React.FC<{\r\n  scroll: number;\r\n  ganttHeight: number;\r\n  ganttFullHeight: number;\r\n  headerHeight: number;\r\n  rtl: boolean;\r\n  onScroll: (event: SyntheticEvent<HTMLDivElement>) => void;\r\n}> = ({\r\n  scroll,\r\n  ganttHeight,\r\n  ganttFullHeight,\r\n  headerHeight,\r\n  rtl,\r\n  onScroll,\r\n}) => {\r\n  const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (scrollRef.current) {\r\n      scrollRef.current.scrollTop = scroll;\r\n      console.log(rtl)\r\n    }\r\n  }, [scroll]);\r\n\r\n  return (\r\n    <div\r\n      className={styles.scrollWrapper}\r\n      style={{\r\n        height: ganttHeight,\r\n        top: headerHeight,\r\n      }}\r\n    >\r\n      <div\r\n        className={styles.scroll}\r\n        onScroll={onScroll}\r\n        ref={scrollRef}\r\n      >\r\n        <div style={{ height: ganttFullHeight, width: 1 }} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { Task } from \"../../types/public-types\";\r\n\r\nexport type TaskListProps = {\r\n  headerHeight: number;\r\n  rowWidth: string;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n  rowHeight: number;\r\n  ganttHeight: number;\r\n  scrollY: number;\r\n  locale: string;\r\n  tasks: Task[];\r\n  taskListRef: React.RefObject<HTMLDivElement>;\r\n  horizontalContainerClass?: string;\r\n  selectedTask: BarTask | undefined;\r\n  setSelectedTask: (task: string) => void;\r\n  onExpanderClick: (task: Task) => void;\r\n  TaskListHeader: React.FC<{\r\n    headerHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n  }>;\r\n  TaskListTable: React.FC<{\r\n    rowHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n    locale: string;\r\n    tasks: Task[];\r\n    selectedTaskId: string;\r\n    setSelectedTask: (taskId: string) => void;\r\n    onExpanderClick: (task: Task) => void;\r\n  }>;\r\n};\r\n\r\nexport const TaskList: React.FC<TaskListProps> = ({\r\n  headerHeight,\r\n  fontFamily,\r\n  fontSize,\r\n  rowWidth,\r\n  rowHeight,\r\n  scrollY,\r\n  tasks,\r\n  selectedTask,\r\n  setSelectedTask,\r\n  onExpanderClick,\r\n  locale,\r\n  ganttHeight,\r\n  taskListRef,\r\n  horizontalContainerClass,\r\n  TaskListHeader,\r\n  TaskListTable,\r\n}) => {\r\n  const horizontalContainerRef = useRef<HTMLDivElement>(null);\r\n  useEffect(() => {\r\n    if (horizontalContainerRef.current) {\r\n      horizontalContainerRef.current.scrollTop = scrollY;\r\n    }\r\n  }, [scrollY]);\r\n\r\n  const headerProps = {\r\n    headerHeight,\r\n    fontFamily,\r\n    fontSize,\r\n    rowWidth,\r\n  };\r\n  const selectedTaskId = selectedTask ? selectedTask.id : \"\";\r\n  const tableProps = {\r\n    rowHeight,\r\n    rowWidth,\r\n    fontFamily,\r\n    fontSize,\r\n    tasks,\r\n    locale,\r\n    selectedTaskId: selectedTaskId,\r\n    setSelectedTask,\r\n    onExpanderClick,\r\n  };\r\n\r\n  return (\r\n    <div ref={taskListRef}>\r\n      <TaskListHeader {...headerProps} />\r\n      <div\r\n        ref={horizontalContainerRef}\r\n        className={horizontalContainerClass}\r\n        style={ganttHeight ? { height: ganttHeight } : {}}\r\n      >\r\n        <TaskListTable {...tableProps} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Task } from \"../../types/public-types\";\r\nimport { addToDate } from \"../../helpers/date-helper\";\r\nimport styles from \"./grid.module.css\";\r\n\r\nexport type GridBodyProps = {\r\n  tasks: Task[];\r\n  dates: Date[];\r\n  svgWidth: number;\r\n  rowHeight: number;\r\n  columnWidth: number;\r\n  todayColor: string;\r\n  rtl: boolean;\r\n};\r\nexport const GridBody: React.FC<GridBodyProps> = ({\r\n  tasks,\r\n  dates,\r\n  rowHeight,\r\n  svgWidth,\r\n  columnWidth,\r\n  todayColor,\r\n  rtl,\r\n}) => {\r\n  const groups = tasks.reduce((acc, t) => {\r\n    const key = t.name ?? \"\";\r\n    if (!acc[key]) acc[key] = [];\r\n    acc[key].push(t);\r\n    return acc;\r\n  }, {} as Record<string, Task[]>);\r\n\r\n  const groupNames = Object.keys(groups);\r\n  const rowCount = groupNames.length;\r\n  const gridRows: React.ReactNode[] = [];\r\n  const rowLines: React.ReactNode[] = [];\r\n\r\n  let totalHeight = rowCount * rowHeight;\r\n\r\n  rowLines.push(\r\n    <line\r\n      key=\"RowLineFirst\"\r\n      x=\"0\"\r\n      y1={0}\r\n      x2={svgWidth}\r\n      y2={0}\r\n      className={styles.gridRowLine}\r\n    />\r\n  );\r\n\r\n  let y = 0;\r\n  for (let i = 0; i < rowCount; i++) {\r\n    gridRows.push(\r\n      <rect\r\n        key={`Row${i}`}\r\n        x=\"0\"\r\n        y={y}\r\n        width={svgWidth}\r\n        height={rowHeight}\r\n        className={styles.gridRow}\r\n      />\r\n    );\r\n    rowLines.push(\r\n      <line\r\n        key={`RowLine${i}`}\r\n        x=\"0\"\r\n        y1={y + rowHeight}\r\n        x2={svgWidth}\r\n        y2={y + rowHeight}\r\n        className={styles.gridRowLine}\r\n      />\r\n    );\r\n    y += rowHeight;\r\n  }\r\n  const now = new Date();\r\n  let tickX = 0;\r\n  const ticks: React.ReactNode[] = [];\r\n  let today: React.ReactNode = <rect />;\r\n  for (let i = 0; i < dates.length; i++) {\r\n    const date = dates[i];\r\n    ticks.push(\r\n      <line\r\n        key={date.getTime()}\r\n        x1={tickX}\r\n        y1={0}\r\n        x2={tickX}\r\n        y2={totalHeight}\r\n        className={styles.gridTick}\r\n      />\r\n    );\r\n    const isToday =\r\n      (i + 1 < dates.length &&\r\n        date.getTime() < now.getTime() &&\r\n        dates[i + 1].getTime() >= now.getTime()) ||\r\n      (i > 0 &&\r\n        i + 1 === dates.length &&\r\n        date.getTime() < now.getTime() &&\r\n        addToDate(\r\n          date,\r\n          date.getTime() - dates[i - 1].getTime(),\r\n          \"millisecond\"\r\n        ).getTime() >= now.getTime());\r\n\r\n    if (isToday) {\r\n      today = (\r\n        <rect\r\n          key=\"today-highlight\"\r\n          x={tickX}\r\n          y={0}\r\n          width={columnWidth}\r\n          height={totalHeight}\r\n          fill={todayColor}\r\n        />\r\n      );\r\n    }\r\n    const isTodayRTL =\r\n      rtl &&\r\n      i + 1 < dates.length &&\r\n      date.getTime() >= now.getTime() &&\r\n      dates[i + 1].getTime() < now.getTime();\r\n\r\n    if (isTodayRTL) {\r\n      today = (\r\n        <rect\r\n          key=\"today-highlight\"\r\n          x={tickX + columnWidth}\r\n          y={0}\r\n          width={columnWidth}\r\n          height={totalHeight}\r\n          fill={todayColor}\r\n        />\r\n      );\r\n    }\r\n\r\n    tickX += columnWidth;\r\n  }\r\n\r\n  return (\r\n    <g className=\"gridBody\">\r\n      <g className=\"rows\">{gridRows}</g>\r\n      <g className=\"rowLines\">{rowLines}</g>\r\n      <g className=\"ticks\">{ticks}</g>\r\n      <g className=\"today\">{today}</g>\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { GridBody, GridBodyProps } from \"./grid-body\";\r\n\r\nexport type GridProps = GridBodyProps;\r\nexport const Grid: React.FC<GridProps> = props => {\r\n  return (\r\n    <g className=\"grid\">\r\n      <GridBody {...props} />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./calendar.module.css\";\r\n\r\ntype TopPartOfCalendarProps = {\r\n  value: string;\r\n  x1Line: number;\r\n  y1Line: number;\r\n  y2Line: number;\r\n  xText: number;\r\n  yText: number;\r\n};\r\n\r\nexport const TopPartOfCalendar: React.FC<TopPartOfCalendarProps> = ({\r\n  value,\r\n  x1Line,\r\n  y1Line,\r\n  y2Line,\r\n  xText,\r\n  yText,\r\n}) => {\r\n  return (\r\n    <g className=\"calendarTop\">\r\n      <line\r\n        x1={x1Line}\r\n        y1={y1Line}\r\n        x2={x1Line}\r\n        y2={y2Line}\r\n        className={styles.calendarTopTick}\r\n        key={value + \"line\"}\r\n      />\r\n      <text\r\n        key={value + \"text\"}\r\n        y={yText}\r\n        x={xText}\r\n        className={styles.calendarTopText}\r\n      >\r\n        {value}\r\n      </text>\r\n    </g>\r\n  );\r\n};\r\n","import React, { ReactChild } from \"react\";\r\nimport { ViewMode } from \"../../types/public-types\";\r\nimport { TopPartOfCalendar } from \"./top-part-of-calendar\";\r\nimport {\r\n  getCachedDateTimeFormat,\r\n  getDaysInMonth,\r\n  getLocalDayOfWeek,\r\n  getLocaleMonth,\r\n  getWeekNumberISO8601,\r\n} from \"../../helpers/date-helper\";\r\nimport { DateSetup } from \"../../types/date-setup\";\r\nimport styles from \"./calendar.module.css\";\r\n\r\nexport type CalendarProps = {\r\n  dateSetup: DateSetup;\r\n  locale: string;\r\n  viewMode: ViewMode;\r\n  rtl: boolean;\r\n  headerHeight: number;\r\n  columnWidth: number;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n};\r\n\r\nexport const Calendar: React.FC<CalendarProps> = ({\r\n  dateSetup,\r\n  locale,\r\n  viewMode,\r\n  rtl,\r\n  headerHeight,\r\n  columnWidth,\r\n  fontFamily,\r\n  fontSize,\r\n}) => {\r\n  const getCalendarValuesForYear = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    for (let i = 0; i < dateSetup.dates.length; i++) {\r\n      const date = dateSetup.dates[i];\r\n      const bottomValue = date.getFullYear();\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (\r\n        i === 0 ||\r\n        date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n      ) {\r\n        const topValue = date.getFullYear().toString();\r\n        let xText: number;\r\n        if (rtl) {\r\n          xText = (6 + i + date.getFullYear() + 1) * columnWidth;\r\n        } else {\r\n          xText = (6 + i - date.getFullYear()) * columnWidth;\r\n        }\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={headerHeight}\r\n            xText={xText}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForQuarterYear = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    for (let i = 0; i < dateSetup.dates.length; i++) {\r\n      const date = dateSetup.dates[i];\r\n      // const bottomValue = getLocaleMonth(date, locale);\r\n      const quarter = \"Q\" + Math.floor((date.getMonth() + 3) / 3);\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {quarter}\r\n        </text>\r\n      );\r\n      if (\r\n        i === 0 ||\r\n        date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n      ) {\r\n        const topValue = date.getFullYear().toString();\r\n        let xText: number;\r\n        if (rtl) {\r\n          xText = (6 + i + date.getMonth() + 1) * columnWidth;\r\n        } else {\r\n          xText = (6 + i - date.getMonth()) * columnWidth;\r\n        }\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={Math.abs(xText)}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForMonth = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    for (let i = 0; i < dateSetup.dates.length; i++) {\r\n      const date = dateSetup.dates[i];\r\n      const bottomValue = getLocaleMonth(date, locale);\r\n      bottomValues.push(\r\n        <text\r\n          key={bottomValue + date.getFullYear()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (\r\n        i === 0 ||\r\n        date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n      ) {\r\n        const topValue = date.getFullYear().toString();\r\n        let xText: number;\r\n        if (rtl) {\r\n          xText = (6 + i + date.getMonth() + 1) * columnWidth;\r\n        } else {\r\n          xText = (6 + i - date.getMonth()) * columnWidth;\r\n        }\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={xText}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForWeek = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    let weeksCount: number = 1;\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = dates.length - 1; i >= 0; i--) {\r\n      const date = dates[i];\r\n      let topValue = \"\";\r\n      if (i === 0 || date.getMonth() !== dates[i - 1].getMonth()) {\r\n        // top\r\n        topValue = `${getLocaleMonth(date, locale)}, ${date.getFullYear()}`;\r\n      }\r\n      // bottom\r\n      const bottomValue = `W${getWeekNumberISO8601(date)}`;\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * (i + +rtl)}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n\r\n      if (topValue) {\r\n        // if last day is new month\r\n        if (i !== dates.length - 1) {\r\n          topValues.push(\r\n            <TopPartOfCalendar\r\n              key={topValue}\r\n              value={topValue}\r\n              x1Line={columnWidth * i + weeksCount * columnWidth}\r\n              y1Line={0}\r\n              y2Line={topDefaultHeight}\r\n              xText={columnWidth * i + columnWidth * weeksCount * 0.5}\r\n              yText={topDefaultHeight * 0.9}\r\n            />\r\n          );\r\n        }\r\n        weeksCount = 0;\r\n      }\r\n      weeksCount++;\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForDay = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      const bottomValue = `${getLocalDayOfWeek(date, locale, \"short\")}, ${date\r\n        .getDate()\r\n        .toString()}`;\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * i + columnWidth * 0.5}\r\n          className={styles.calendarBottomText}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (\r\n        i + 1 !== dates.length &&\r\n        date.getMonth() !== dates[i + 1].getMonth()\r\n      ) {\r\n        const topValue = getLocaleMonth(date, locale);\r\n\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue + date.getFullYear()}\r\n            value={topValue}\r\n            x1Line={columnWidth * (i + 1)}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={\r\n              columnWidth * (i + 1) -\r\n              getDaysInMonth(date.getMonth(), date.getFullYear()) *\r\n                columnWidth *\r\n                0.5\r\n            }\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForPartOfDay = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const ticks = viewMode === ViewMode.HalfDay ? 2 : 4;\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      const bottomValue = getCachedDateTimeFormat(locale, {\r\n        hour: \"numeric\",\r\n      }).format(date);\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * (i + +rtl)}\r\n          className={styles.calendarBottomText}\r\n          fontFamily={fontFamily}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (i === 0 || date.getDate() !== dates[i - 1].getDate()) {\r\n        const topValue = `${getLocalDayOfWeek(\r\n          date,\r\n          locale,\r\n          \"short\"\r\n        )}, ${date.getDate()} ${getLocaleMonth(date, locale)}`;\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue + date.getFullYear()}\r\n            value={topValue}\r\n            x1Line={columnWidth * i + ticks * columnWidth}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={columnWidth * i + ticks * columnWidth * 0.5}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  const getCalendarValuesForHour = () => {\r\n    const topValues: ReactChild[] = [];\r\n    const bottomValues: ReactChild[] = [];\r\n    const topDefaultHeight = headerHeight * 0.5;\r\n    const dates = dateSetup.dates;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      const bottomValue = getCachedDateTimeFormat(locale, {\r\n        hour: \"numeric\",\r\n      }).format(date);\r\n\r\n      bottomValues.push(\r\n        <text\r\n          key={date.getTime()}\r\n          y={headerHeight * 0.8}\r\n          x={columnWidth * (i + +rtl)}\r\n          className={styles.calendarBottomText}\r\n          fontFamily={fontFamily}\r\n        >\r\n          {bottomValue}\r\n        </text>\r\n      );\r\n      if (i !== 0 && date.getDate() !== dates[i - 1].getDate()) {\r\n        const displayDate = dates[i - 1];\r\n        const topValue = `${getLocalDayOfWeek(\r\n          displayDate,\r\n          locale,\r\n          \"long\"\r\n        )}, ${displayDate.getDate()} ${getLocaleMonth(displayDate, locale)}`;\r\n        const topPosition = (date.getHours() - 24) / 2;\r\n        topValues.push(\r\n          <TopPartOfCalendar\r\n            key={topValue + displayDate.getFullYear()}\r\n            value={topValue}\r\n            x1Line={columnWidth * i}\r\n            y1Line={0}\r\n            y2Line={topDefaultHeight}\r\n            xText={columnWidth * (i + topPosition)}\r\n            yText={topDefaultHeight * 0.9}\r\n          />\r\n        );\r\n      }\r\n    }\r\n\r\n    return [topValues, bottomValues];\r\n  };\r\n\r\n  let topValues: ReactChild[] = [];\r\n  let bottomValues: ReactChild[] = [];\r\n  switch (dateSetup.viewMode) {\r\n    case ViewMode.Year:\r\n      [topValues, bottomValues] = getCalendarValuesForYear();\r\n      break;\r\n    case ViewMode.QuarterYear:\r\n      [topValues, bottomValues] = getCalendarValuesForQuarterYear();\r\n      break;\r\n    case ViewMode.Month:\r\n      [topValues, bottomValues] = getCalendarValuesForMonth();\r\n      break;\r\n    case ViewMode.Week:\r\n      [topValues, bottomValues] = getCalendarValuesForWeek();\r\n      break;\r\n    case ViewMode.Day:\r\n      [topValues, bottomValues] = getCalendarValuesForDay();\r\n      break;\r\n    case ViewMode.QuarterDay:\r\n    case ViewMode.HalfDay:\r\n      [topValues, bottomValues] = getCalendarValuesForPartOfDay();\r\n      break;\r\n    case ViewMode.Hour:\r\n      [topValues, bottomValues] = getCalendarValuesForHour();\r\n  }\r\n  return (\r\n    <g className=\"calendar\" fontSize={fontSize} fontFamily={fontFamily}>\r\n      <rect\r\n        x={0}\r\n        y={0}\r\n        width={columnWidth * dateSetup.dates.length}\r\n        height={headerHeight}\r\n        className={styles.calendarHeader}\r\n      />\r\n      {bottomValues} {topValues}\r\n    </g>\r\n  );\r\n};\r\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import React from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\n\r\ntype ArrowProps = {\r\n  taskFrom: BarTask;\r\n  taskTo: BarTask;\r\n  rowHeight: number;\r\n  taskHeight: number;\r\n  arrowIndent: number;\r\n  rtl: boolean;\r\n};\r\nexport const Arrow: React.FC<ArrowProps> = ({\r\n  taskFrom,\r\n  taskTo,\r\n  rowHeight,\r\n  taskHeight,\r\n  arrowIndent,\r\n  rtl,\r\n}) => {\r\n  let path: string;\r\n  let trianglePoints: string;\r\n  if (rtl) {\r\n    [path, trianglePoints] = drownPathAndTriangleRTL(\r\n      taskFrom,\r\n      taskTo,\r\n      rowHeight,\r\n      taskHeight,\r\n      arrowIndent\r\n    );\r\n  } else {\r\n    [path, trianglePoints] = drownPathAndTriangle(\r\n      taskFrom,\r\n      taskTo,\r\n      rowHeight,\r\n      taskHeight,\r\n      arrowIndent\r\n    );\r\n  }\r\n\r\n  return (\r\n    <g className=\"arrow\">\r\n      <path strokeWidth=\"1.5\" d={path} fill=\"none\" />\r\n      <polygon points={trianglePoints} />\r\n    </g>\r\n  );\r\n};\r\n\r\nconst drownPathAndTriangle = (\r\n  taskFrom: BarTask,\r\n  taskTo: BarTask,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  arrowIndent: number\r\n) => {\r\n  const indexCompare = taskFrom.index > taskTo.index ? -1 : 1;\r\n  const taskToEndPosition = taskTo.y + taskHeight / 2;\r\n  const taskFromEndPosition = taskFrom.x2 + arrowIndent * 2;\r\n  const taskFromHorizontalOffsetValue =\r\n    taskFromEndPosition < taskTo.x1 ? \"\" : `H ${taskTo.x1 - arrowIndent}`;\r\n  const taskToHorizontalOffsetValue =\r\n    taskFromEndPosition > taskTo.x1\r\n      ? arrowIndent\r\n      : taskTo.x1 - taskFrom.x2 - arrowIndent;\r\n\r\n  const path = `M ${taskFrom.x2} ${taskFrom.y + taskHeight / 2} \r\n  h ${arrowIndent} \r\n  v ${(indexCompare * rowHeight) / 2} \r\n  ${taskFromHorizontalOffsetValue}\r\n  V ${taskToEndPosition} \r\n  h ${taskToHorizontalOffsetValue}`;\r\n\r\n  const trianglePoints = `${taskTo.x1},${taskToEndPosition} \r\n  ${taskTo.x1 - 5},${taskToEndPosition - 5} \r\n  ${taskTo.x1 - 5},${taskToEndPosition + 5}`;\r\n  return [path, trianglePoints];\r\n};\r\n\r\nconst drownPathAndTriangleRTL = (\r\n  taskFrom: BarTask,\r\n  taskTo: BarTask,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  arrowIndent: number\r\n) => {\r\n  const indexCompare = taskFrom.index > taskTo.index ? -1 : 1;\r\n  const taskToEndPosition = taskTo.y + taskHeight / 2;\r\n  const taskFromEndPosition = taskFrom.x1 - arrowIndent * 2;\r\n  const taskFromHorizontalOffsetValue =\r\n    taskFromEndPosition > taskTo.x2 ? \"\" : `H ${taskTo.x2 + arrowIndent}`;\r\n  const taskToHorizontalOffsetValue =\r\n    taskFromEndPosition < taskTo.x2\r\n      ? -arrowIndent\r\n      : taskTo.x2 - taskFrom.x1 + arrowIndent;\r\n\r\n  const path = `M ${taskFrom.x1} ${taskFrom.y + taskHeight / 2} \r\n  h ${-arrowIndent} \r\n  v ${(indexCompare * rowHeight) / 2} \r\n  ${taskFromHorizontalOffsetValue}\r\n  V ${taskToEndPosition} \r\n  h ${taskToHorizontalOffsetValue}`;\r\n\r\n  const trianglePoints = `${taskTo.x2},${taskToEndPosition} \r\n  ${taskTo.x2 + 5},${taskToEndPosition + 5} \r\n  ${taskTo.x2 + 5},${taskToEndPosition - 5}`;\r\n  return [path, trianglePoints];\r\n};\r\n","import { Task } from \"../types/public-types\";\r\nimport { BarTask, TaskTypeInternal } from \"../types/bar-task\";\r\nimport { BarMoveAction } from \"../types/gantt-task-actions\";\r\n\r\nexport const convertToBarTasks = (\r\n  tasks: Task[],\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  rtl: boolean,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  projectProgressColor: string,\r\n  projectProgressSelectedColor: string,\r\n  projectBackgroundColor: string,\r\n  projectBackgroundSelectedColor: string,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n) => {\r\n\r\n  const grouped = Object.values(\r\n    tasks.reduce((acc, t) => {\r\n      const key = t.name ?? \"\";\r\n      if (!acc[key]) acc[key] = [];\r\n      acc[key].push(t);\r\n      return acc;\r\n    }, {} as Record<string, Task[]>)\r\n  );\r\n\r\n  let barTasks: BarTask[] = [];\r\n\r\n  grouped.forEach((employeeTasks, rowIndex) => {\r\n    employeeTasks.forEach((t) => {\r\n      const bar = convertToBarTask(\r\n        t,\r\n        rowIndex,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        rtl,\r\n        barProgressColor,\r\n        barProgressSelectedColor,\r\n        barBackgroundColor,\r\n        barBackgroundSelectedColor,\r\n        projectProgressColor,\r\n        projectProgressSelectedColor,\r\n        projectBackgroundColor,\r\n        projectBackgroundSelectedColor,\r\n        milestoneBackgroundColor,\r\n        milestoneBackgroundSelectedColor\r\n      );\r\n\r\n      barTasks.push(bar);\r\n    });\r\n  });\r\n\r\n  barTasks = barTasks.map(task => {\r\n    const dependencies = task.dependencies || [];\r\n    for (let j = 0; j < dependencies.length; j++) {\r\n      const dependence = barTasks.findIndex(value => value.id === dependencies[j]);\r\n      if (dependence !== -1) barTasks[dependence].barChildren.push(task);\r\n    }\r\n    return task;\r\n  });\r\n\r\n  return barTasks;\r\n};\r\n\r\n\r\nconst convertToBarTask = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  rtl: boolean,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  projectProgressColor: string,\r\n  projectProgressSelectedColor: string,\r\n  projectBackgroundColor: string,\r\n  projectBackgroundSelectedColor: string,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n): BarTask => {\r\n  let barTask: BarTask;\r\n  switch (task.type) {\r\n    case \"milestone\":\r\n      barTask = convertToMilestone(\r\n        task,\r\n        index,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        milestoneBackgroundColor,\r\n        milestoneBackgroundSelectedColor\r\n      );\r\n      break;\r\n    case \"project\":\r\n      barTask = convertToBar(\r\n        task,\r\n        index,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        rtl,\r\n        projectProgressColor,\r\n        projectProgressSelectedColor,\r\n        projectBackgroundColor,\r\n        projectBackgroundSelectedColor\r\n      );\r\n      break;\r\n    default:\r\n      barTask = convertToBar(\r\n        task,\r\n        index,\r\n        dates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        rtl,\r\n        barProgressColor,\r\n        barProgressSelectedColor,\r\n        barBackgroundColor,\r\n        barBackgroundSelectedColor\r\n      );\r\n      break;\r\n  }\r\n  return barTask;\r\n};\r\n\r\nconst convertToBar = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  rtl: boolean,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string\r\n): BarTask => {\r\n  let x1: number;\r\n  let x2: number;\r\n  if (rtl) {\r\n    x2 = taskXCoordinateRTL(task.start, dates, columnWidth);\r\n    x1 = taskXCoordinateRTL(task.end, dates, columnWidth);\r\n  } else {\r\n    x1 = taskXCoordinate(task.start, dates, columnWidth);\r\n    x2 = taskXCoordinate(task.end, dates, columnWidth);\r\n  }\r\n  let typeInternal: TaskTypeInternal = task.type;\r\n  if (typeInternal === \"task\" && x2 - x1 < handleWidth * 2) {\r\n    typeInternal = \"smalltask\";\r\n    x2 = x1 + handleWidth * 2;\r\n  }\r\n\r\n  const [progressWidth, progressX] = progressWithByParams(\r\n    x1,\r\n    x2,\r\n    task.progress,\r\n    rtl\r\n  );\r\n  const y = taskYCoordinate(index, rowHeight, taskHeight);\r\n  const hideChildren = task.type === \"project\" ? task.hideChildren : undefined;\r\n\r\n  const styles = {\r\n    backgroundColor: barBackgroundColor,\r\n    backgroundSelectedColor: barBackgroundSelectedColor,\r\n    progressColor: barProgressColor,\r\n    progressSelectedColor: barProgressSelectedColor,\r\n    ...task.styles,\r\n  };\r\n  return {\r\n    ...task,\r\n    typeInternal,\r\n    x1,\r\n    x2,\r\n    y,\r\n    index,\r\n    progressX,\r\n    progressWidth,\r\n    barCornerRadius,\r\n    handleWidth,\r\n    hideChildren,\r\n    height: taskHeight,\r\n    barChildren: [],\r\n    styles,\r\n  };\r\n};\r\n\r\nconst convertToMilestone = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n): BarTask => {\r\n  const x = taskXCoordinate(task.start, dates, columnWidth);\r\n  const y = taskYCoordinate(index, rowHeight, taskHeight);\r\n\r\n  const x1 = x - taskHeight * 0.5;\r\n  const x2 = x + taskHeight * 0.5;\r\n\r\n  const rotatedHeight = taskHeight / 1.414;\r\n  const styles = {\r\n    backgroundColor: milestoneBackgroundColor,\r\n    backgroundSelectedColor: milestoneBackgroundSelectedColor,\r\n    progressColor: \"\",\r\n    progressSelectedColor: \"\",\r\n    ...task.styles,\r\n  };\r\n  return {\r\n    ...task,\r\n    end: task.start,\r\n    x1,\r\n    x2,\r\n    y,\r\n    index,\r\n    progressX: 0,\r\n    progressWidth: 0,\r\n    barCornerRadius,\r\n    handleWidth,\r\n    typeInternal: task.type,\r\n    progress: 0,\r\n    height: rotatedHeight,\r\n    hideChildren: undefined,\r\n    barChildren: [],\r\n    styles,\r\n  };\r\n};\r\n\r\nconst taskXCoordinate = (xDate: Date, dates: Date[], columnWidth: number) => {\r\n  const index = dates.findIndex(d => d.getTime() >= xDate.getTime()) - 1;\r\n\r\n  const remainderMillis = xDate.getTime() - dates[index].getTime();\r\n  const percentOfInterval =\r\n    remainderMillis / (dates[index + 1].getTime() - dates[index].getTime());\r\n  const x = index * columnWidth + percentOfInterval * columnWidth;\r\n  return x;\r\n};\r\nconst taskXCoordinateRTL = (\r\n  xDate: Date,\r\n  dates: Date[],\r\n  columnWidth: number\r\n) => {\r\n  let x = taskXCoordinate(xDate, dates, columnWidth);\r\n  x += columnWidth;\r\n  return x;\r\n};\r\nconst taskYCoordinate = (\r\n  index: number,\r\n  rowHeight: number,\r\n  taskHeight: number\r\n) => {\r\n  const y = index * rowHeight + (rowHeight - taskHeight) / 2;\r\n  return y;\r\n};\r\n\r\nexport const progressWithByParams = (\r\n  taskX1: number,\r\n  taskX2: number,\r\n  progress: number,\r\n  rtl: boolean\r\n) => {\r\n  const progressWidth = (taskX2 - taskX1) * progress * 0.01;\r\n  let progressX: number;\r\n  if (rtl) {\r\n    progressX = taskX2 - progressWidth;\r\n  } else {\r\n    progressX = taskX1;\r\n  }\r\n  return [progressWidth, progressX];\r\n};\r\n\r\nexport const progressByProgressWidth = (\r\n  progressWidth: number,\r\n  barTask: BarTask\r\n) => {\r\n  const barWidth = barTask.x2 - barTask.x1;\r\n  const progressPercent = Math.round((progressWidth * 100) / barWidth);\r\n  if (progressPercent >= 100) return 100;\r\n  else if (progressPercent <= 0) return 0;\r\n  else return progressPercent;\r\n};\r\n\r\nconst progressByX = (x: number, task: BarTask) => {\r\n  if (x >= task.x2) return 100;\r\n  else if (x <= task.x1) return 0;\r\n  else {\r\n    const barWidth = task.x2 - task.x1;\r\n    const progressPercent = Math.round(((x - task.x1) * 100) / barWidth);\r\n    return progressPercent;\r\n  }\r\n};\r\nconst progressByXRTL = (x: number, task: BarTask) => {\r\n  if (x >= task.x2) return 0;\r\n  else if (x <= task.x1) return 100;\r\n  else {\r\n    const barWidth = task.x2 - task.x1;\r\n    const progressPercent = Math.round(((task.x2 - x) * 100) / barWidth);\r\n    return progressPercent;\r\n  }\r\n};\r\n\r\nexport const getProgressPoint = (\r\n  progressX: number,\r\n  taskY: number,\r\n  taskHeight: number\r\n) => {\r\n  const point = [\r\n    progressX - 5,\r\n    taskY + taskHeight,\r\n    progressX + 5,\r\n    taskY + taskHeight,\r\n    progressX,\r\n    taskY + taskHeight - 8.66,\r\n  ];\r\n  return point.join(\",\");\r\n};\r\n\r\nconst startByX = (x: number, xStep: number, task: BarTask) => {\r\n  if (x >= task.x2 - task.handleWidth * 2) {\r\n    x = task.x2 - task.handleWidth * 2;\r\n  }\r\n  const steps = Math.round((x - task.x1) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX = task.x1 + additionalXValue;\r\n  return newX;\r\n};\r\n\r\nconst endByX = (x: number, xStep: number, task: BarTask) => {\r\n  if (x <= task.x1 + task.handleWidth * 2) {\r\n    x = task.x1 + task.handleWidth * 2;\r\n  }\r\n  const steps = Math.round((x - task.x2) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX = task.x2 + additionalXValue;\r\n  return newX;\r\n};\r\n\r\nconst moveByX = (x: number, xStep: number, task: BarTask) => {\r\n  const steps = Math.round((x - task.x1) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX1 = task.x1 + additionalXValue;\r\n  const newX2 = newX1 + task.x2 - task.x1;\r\n  return [newX1, newX2];\r\n};\r\n\r\nconst dateByX = (\r\n  x: number,\r\n  taskX: number,\r\n  taskDate: Date,\r\n  xStep: number,\r\n  timeStep: number\r\n) => {\r\n  let newDate = new Date(((x - taskX) / xStep) * timeStep + taskDate.getTime());\r\n  newDate = new Date(\r\n    newDate.getTime() +\r\n      (newDate.getTimezoneOffset() - taskDate.getTimezoneOffset()) * 60000\r\n  );\r\n  return newDate;\r\n};\r\n\r\n/**\r\n * Method handles event in real time(mousemove) and on finish(mouseup)\r\n */\r\nexport const handleTaskBySVGMouseEvent = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number,\r\n  rtl: boolean\r\n): { isChanged: boolean; changedTask: BarTask } => {\r\n  let result: { isChanged: boolean; changedTask: BarTask };\r\n  switch (selectedTask.type) {\r\n    case \"milestone\":\r\n      result = handleTaskBySVGMouseEventForMilestone(\r\n        svgX,\r\n        action,\r\n        selectedTask,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta\r\n      );\r\n      break;\r\n    default:\r\n      result = handleTaskBySVGMouseEventForBar(\r\n        svgX,\r\n        action,\r\n        selectedTask,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta,\r\n        rtl\r\n      );\r\n      break;\r\n  }\r\n  return result;\r\n};\r\n\r\nconst handleTaskBySVGMouseEventForBar = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number,\r\n  rtl: boolean\r\n): { isChanged: boolean; changedTask: BarTask } => {\r\n  const changedTask: BarTask = { ...selectedTask };\r\n  let isChanged = false;\r\n  switch (action) {\r\n    case \"progress\":\r\n      if (rtl) {\r\n        changedTask.progress = progressByXRTL(svgX, selectedTask);\r\n      } else {\r\n        changedTask.progress = progressByX(svgX, selectedTask);\r\n      }\r\n      isChanged = changedTask.progress !== selectedTask.progress;\r\n      if (isChanged) {\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    case \"start\": {\r\n      const newX1 = startByX(svgX, xStep, selectedTask);\r\n      changedTask.x1 = newX1;\r\n      isChanged = changedTask.x1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        if (rtl) {\r\n          changedTask.end = dateByX(\r\n            newX1,\r\n            selectedTask.x1,\r\n            selectedTask.end,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        } else {\r\n          changedTask.start = dateByX(\r\n            newX1,\r\n            selectedTask.x1,\r\n            selectedTask.start,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        }\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    }\r\n    case \"end\": {\r\n      const newX2 = endByX(svgX, xStep, selectedTask);\r\n      changedTask.x2 = newX2;\r\n      isChanged = changedTask.x2 !== selectedTask.x2;\r\n      if (isChanged) {\r\n        if (rtl) {\r\n          changedTask.start = dateByX(\r\n            newX2,\r\n            selectedTask.x2,\r\n            selectedTask.start,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        } else {\r\n          changedTask.end = dateByX(\r\n            newX2,\r\n            selectedTask.x2,\r\n            selectedTask.end,\r\n            xStep,\r\n            timeStep\r\n          );\r\n        }\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    }\r\n    case \"move\": {\r\n      const [newMoveX1, newMoveX2] = moveByX(\r\n        svgX - initEventX1Delta,\r\n        xStep,\r\n        selectedTask\r\n      );\r\n      isChanged = newMoveX1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        changedTask.start = dateByX(\r\n          newMoveX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.end = dateByX(\r\n          newMoveX2,\r\n          selectedTask.x2,\r\n          selectedTask.end,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.x1 = newMoveX1;\r\n        changedTask.x2 = newMoveX2;\r\n        const [progressWidth, progressX] = progressWithByParams(\r\n          changedTask.x1,\r\n          changedTask.x2,\r\n          changedTask.progress,\r\n          rtl\r\n        );\r\n        changedTask.progressWidth = progressWidth;\r\n        changedTask.progressX = progressX;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  return { isChanged, changedTask };\r\n};\r\n\r\nconst handleTaskBySVGMouseEventForMilestone = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number\r\n): { isChanged: boolean; changedTask: BarTask } => {\r\n  const changedTask: BarTask = { ...selectedTask };\r\n  let isChanged = false;\r\n  switch (action) {\r\n    case \"move\": {\r\n      const [newMoveX1, newMoveX2] = moveByX(\r\n        svgX - initEventX1Delta,\r\n        xStep,\r\n        selectedTask\r\n      );\r\n      isChanged = newMoveX1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        changedTask.start = dateByX(\r\n          newMoveX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.end = changedTask.start;\r\n        changedTask.x1 = newMoveX1;\r\n        changedTask.x2 = newMoveX2;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  return { isChanged, changedTask };\r\n};\r\n","import { BarTask } from \"../types/bar-task\";\r\nimport { Task } from \"../types/public-types\";\r\n\r\nexport function isKeyboardEvent(\r\n  event: React.MouseEvent | React.KeyboardEvent | React.FocusEvent\r\n): event is React.KeyboardEvent {\r\n  return (event as React.KeyboardEvent).key !== undefined;\r\n}\r\n\r\nexport function isMouseEvent(\r\n  event: React.MouseEvent | React.KeyboardEvent | React.FocusEvent\r\n): event is React.MouseEvent {\r\n  return (event as React.MouseEvent).clientX !== undefined;\r\n}\r\n\r\nexport function isBarTask(task: Task | BarTask): task is BarTask {\r\n  return (task as BarTask).x1 !== undefined;\r\n}\r\n\r\nexport function removeHiddenTasks(tasks: Task[]) {\r\n  const groupedTasks = tasks.filter(\r\n    t => t.hideChildren && t.type === \"project\"\r\n  );\r\n  if (groupedTasks.length > 0) {\r\n    for (let i = 0; groupedTasks.length > i; i++) {\r\n      const groupedTask = groupedTasks[i];\r\n      const children = getChildren(tasks, groupedTask);\r\n      tasks = tasks.filter(t => children.indexOf(t) === -1);\r\n    }\r\n  }\r\n  return tasks;\r\n}\r\n\r\nfunction getChildren(taskList: Task[], task: Task) {\r\n  let tasks: Task[] = [];\r\n  if (task.type !== \"project\") {\r\n    tasks = taskList.filter(\r\n      t => t.dependencies && t.dependencies.indexOf(task.id) !== -1\r\n    );\r\n  } else {\r\n    tasks = taskList.filter(t => t.project && t.project === task.id);\r\n  }\r\n  var taskChildren: Task[] = [];\r\n  tasks.forEach(t => {\r\n    taskChildren.push(...getChildren(taskList, t));\r\n  })\r\n  tasks = tasks.concat(tasks, taskChildren);\r\n  return tasks;\r\n}\r\n\r\nexport const sortTasks = (taskA: Task, taskB: Task) => {\r\n  const orderA = taskA.displayOrder || Number.MAX_VALUE;\r\n  const orderB = taskB.displayOrder || Number.MAX_VALUE;\r\n  if (orderA > orderB) {\r\n    return 1;\r\n  } else if (orderA < orderB) {\r\n    return -1;\r\n  } else {\r\n    return 0;\r\n  }\r\n};\r\n","import React from \"react\";\r\nimport style from \"./bar.module.css\";\r\n\r\ntype BarDisplayProps = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  isSelected: boolean;\r\n  /* progress start point */\r\n  progressX: number;\r\n  progressWidth: number;\r\n  barCornerRadius: number;\r\n  styles: {\r\n    backgroundColor: string;\r\n    backgroundSelectedColor: string;\r\n    progressColor: string;\r\n    progressSelectedColor: string;\r\n  };\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n};\r\nexport const BarDisplay: React.FC<BarDisplayProps> = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  isSelected,\r\n  progressX,\r\n  progressWidth,\r\n  barCornerRadius,\r\n  styles,\r\n  onMouseDown,\r\n}) => {\r\n  const getProcessColor = () => {\r\n    return isSelected ? styles.progressSelectedColor : styles.progressColor;\r\n  };\r\n\r\n  const getBarColor = () => {\r\n    return isSelected ? styles.backgroundSelectedColor : styles.backgroundColor;\r\n  };\r\n\r\n  return (\r\n    <g onMouseDown={onMouseDown}>\r\n      <rect\r\n        x={x}\r\n        width={width}\r\n        y={y}\r\n        height={height}\r\n        ry={barCornerRadius}\r\n        rx={barCornerRadius}\r\n        fill={getBarColor()}\r\n        className={style.barBackground}\r\n      />\r\n      <rect\r\n        x={progressX}\r\n        width={progressWidth}\r\n        y={y}\r\n        height={height}\r\n        ry={barCornerRadius}\r\n        rx={barCornerRadius}\r\n        fill={getProcessColor()}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./bar.module.css\";\r\n\r\ntype BarDateHandleProps = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  barCornerRadius: number;\r\n  onMouseDown: (event: React.MouseEvent<SVGRectElement, MouseEvent>) => void;\r\n};\r\nexport const BarDateHandle: React.FC<BarDateHandleProps> = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  barCornerRadius,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <rect\r\n      x={x}\r\n      y={y}\r\n      width={width}\r\n      height={height}\r\n      className={styles.barHandle}\r\n      ry={barCornerRadius}\r\n      rx={barCornerRadius}\r\n      onMouseDown={onMouseDown}\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./bar.module.css\";\r\n\r\ntype BarProgressHandleProps = {\r\n  progressPoint: string;\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n};\r\nexport const BarProgressHandle: React.FC<BarProgressHandleProps> = ({\r\n  progressPoint,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <polygon\r\n      className={styles.barHandle}\r\n      points={progressPoint}\r\n      onMouseDown={onMouseDown}\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { getProgressPoint } from \"../../../helpers/bar-helper\";\r\nimport { BarDisplay } from \"./bar-display\";\r\nimport { BarDateHandle } from \"./bar-date-handle\";\r\nimport { BarProgressHandle } from \"./bar-progress-handle\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./bar.module.css\";\r\n\r\nexport const Bar: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isProgressChangeable,\r\n  isDateChangeable,\r\n  rtl,\r\n  onEventStart,\r\n  isSelected,\r\n}) => {\r\n  const progressPoint = getProgressPoint(\r\n    +!rtl * task.progressWidth + task.progressX,\r\n    task.y,\r\n    task.height\r\n  );\r\n  const handleHeight = task.height - 2;\r\n  return (\r\n    <g className={styles.barWrapper} tabIndex={0}>\r\n      <BarDisplay\r\n        x={task.x1}\r\n        y={task.y}\r\n        width={task.x2 - task.x1}\r\n        height={task.height}\r\n        progressX={task.progressX}\r\n        progressWidth={task.progressWidth}\r\n        barCornerRadius={task.barCornerRadius}\r\n        styles={task.styles}\r\n        isSelected={isSelected}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n      <g className=\"handleGroup\">\r\n        {isDateChangeable && (\r\n          <g>\r\n            {/* left */}\r\n            <BarDateHandle\r\n              x={task.x1 + 1}\r\n              y={task.y + 1}\r\n              width={task.handleWidth}\r\n              height={handleHeight}\r\n              barCornerRadius={task.barCornerRadius}\r\n              onMouseDown={e => {\r\n                onEventStart(\"start\", task, e);\r\n              }}\r\n            />\r\n            {/* right */}\r\n            <BarDateHandle\r\n              x={task.x2 - task.handleWidth - 1}\r\n              y={task.y + 1}\r\n              width={task.handleWidth}\r\n              height={handleHeight}\r\n              barCornerRadius={task.barCornerRadius}\r\n              onMouseDown={e => {\r\n                onEventStart(\"end\", task, e);\r\n              }}\r\n            />\r\n          </g>\r\n        )}\r\n        {isProgressChangeable && (\r\n          <BarProgressHandle\r\n            progressPoint={progressPoint}\r\n            onMouseDown={e => {\r\n              onEventStart(\"progress\", task, e);\r\n            }}\r\n          />\r\n        )}\r\n      </g>\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { getProgressPoint } from \"../../../helpers/bar-helper\";\r\nimport { BarDisplay } from \"./bar-display\";\r\nimport { BarProgressHandle } from \"./bar-progress-handle\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./bar.module.css\";\r\n\r\nexport const BarSmall: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isProgressChangeable,\r\n  isDateChangeable,\r\n  onEventStart,\r\n  isSelected,\r\n}) => {\r\n  const progressPoint = getProgressPoint(\r\n    task.progressWidth + task.x1,\r\n    task.y,\r\n    task.height\r\n  );\r\n  return (\r\n    <g className={styles.barWrapper} tabIndex={0}>\r\n      <BarDisplay\r\n        x={task.x1}\r\n        y={task.y}\r\n        width={task.x2 - task.x1}\r\n        height={task.height}\r\n        progressX={task.progressX}\r\n        progressWidth={task.progressWidth}\r\n        barCornerRadius={task.barCornerRadius}\r\n        styles={task.styles}\r\n        isSelected={isSelected}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n      <g className=\"handleGroup\">\r\n        {isProgressChangeable && (\r\n          <BarProgressHandle\r\n            progressPoint={progressPoint}\r\n            onMouseDown={e => {\r\n              onEventStart(\"progress\", task, e);\r\n            }}\r\n          />\r\n        )}\r\n      </g>\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./milestone.module.css\";\r\n\r\nexport const Milestone: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isDateChangeable,\r\n  onEventStart,\r\n  isSelected,\r\n}) => {\r\n  const transform = `rotate(45 ${task.x1 + task.height * 0.356} \r\n    ${task.y + task.height * 0.85})`;\r\n  const getBarColor = () => {\r\n    return isSelected\r\n      ? task.styles.backgroundSelectedColor\r\n      : task.styles.backgroundColor;\r\n  };\r\n\r\n  return (\r\n    <g tabIndex={0} className={styles.milestoneWrapper}>\r\n      <rect\r\n        fill={getBarColor()}\r\n        x={task.x1}\r\n        width={task.height}\r\n        y={task.y}\r\n        height={task.height}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        transform={transform}\r\n        className={styles.milestoneBackground}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./project.module.css\";\r\n\r\nexport const Project: React.FC<TaskItemProps> = ({ task, isSelected }) => {\r\n  const barColor = isSelected\r\n    ? task.styles.backgroundSelectedColor\r\n    : task.styles.backgroundColor;\r\n  const processColor = isSelected\r\n    ? task.styles.progressSelectedColor\r\n    : task.styles.progressColor;\r\n  const projectWith = task.x2 - task.x1;\r\n\r\n  const projectLeftTriangle = [\r\n    task.x1,\r\n    task.y + task.height / 2 - 1,\r\n    task.x1,\r\n    task.y + task.height,\r\n    task.x1 + 15,\r\n    task.y + task.height / 2 - 1,\r\n  ].join(\",\");\r\n  const projectRightTriangle = [\r\n    task.x2,\r\n    task.y + task.height / 2 - 1,\r\n    task.x2,\r\n    task.y + task.height,\r\n    task.x2 - 15,\r\n    task.y + task.height / 2 - 1,\r\n  ].join(\",\");\r\n\r\n  return (\r\n    <g tabIndex={0} className={styles.projectWrapper}>\r\n      <rect\r\n        fill={barColor}\r\n        x={task.x1}\r\n        width={projectWith}\r\n        y={task.y}\r\n        height={task.height}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        className={styles.projectBackground}\r\n      />\r\n      <rect\r\n        x={task.progressX}\r\n        width={task.progressWidth}\r\n        y={task.y}\r\n        height={task.height}\r\n        ry={task.barCornerRadius}\r\n        rx={task.barCornerRadius}\r\n        fill={processColor}\r\n      />\r\n      <rect\r\n        fill={barColor}\r\n        x={task.x1}\r\n        width={projectWith}\r\n        y={task.y}\r\n        height={task.height / 2}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        className={styles.projectTop}\r\n      />\r\n      <polygon\r\n        className={styles.projectTop}\r\n        points={projectLeftTriangle}\r\n        fill={barColor}\r\n      />\r\n      <polygon\r\n        className={styles.projectTop}\r\n        points={projectRightTriangle}\r\n        fill={barColor}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { GanttContentMoveAction } from \"../../types/gantt-task-actions\";\r\nimport { Bar } from \"./bar/bar\";\r\nimport { BarSmall } from \"./bar/bar-small\";\r\nimport { Milestone } from \"./milestone/milestone\";\r\nimport { Project } from \"./project/project\";\r\nimport style from \"./task-list.module.css\";\r\n\r\nexport type TaskItemProps = {\r\n  task: BarTask;\r\n  arrowIndent: number;\r\n  taskHeight: number;\r\n  isProgressChangeable: boolean;\r\n  isDateChangeable: boolean;\r\n  isDelete: boolean;\r\n  isSelected: boolean;\r\n  rtl: boolean;\r\n  onEventStart: (\r\n    action: GanttContentMoveAction,\r\n    selectedTask: BarTask,\r\n    event?: React.MouseEvent | React.KeyboardEvent\r\n  ) => any;\r\n};\r\n\r\nexport const TaskItem: React.FC<TaskItemProps> = props => {\r\n  const {\r\n    task,\r\n    arrowIndent,\r\n    isDelete,\r\n    taskHeight,\r\n    isSelected,\r\n    rtl,\r\n    onEventStart,\r\n  } = {\r\n    ...props,\r\n  };\r\n  const textRef = useRef<SVGTextElement>(null);\r\n  const [taskItem, setTaskItem] = useState<JSX.Element>(<div />);\r\n  const [isTextInside, setIsTextInside] = useState(true);\r\n\r\n  useEffect(() => {\r\n    switch (task.typeInternal) {\r\n      case \"milestone\":\r\n        setTaskItem(<Milestone {...props} />);\r\n        break;\r\n      case \"project\":\r\n        setTaskItem(<Project {...props} />);\r\n        break;\r\n      case \"smalltask\":\r\n        setTaskItem(<BarSmall {...props} />);\r\n        break;\r\n      default:\r\n        setTaskItem(<Bar {...props} />);\r\n        break;\r\n    }\r\n  }, [task, isSelected]);\r\n\r\n  useEffect(() => {\r\n    if (textRef.current) {\r\n      setIsTextInside(textRef.current.getBBox().width < task.x2 - task.x1);\r\n    }\r\n  }, [textRef, task]);\r\n\r\n  const getX = () => {\r\n    const width = task.x2 - task.x1;\r\n    const hasChild = task.barChildren.length > 0;\r\n    if (isTextInside) {\r\n      return task.x1 + width * 0.5;\r\n    }\r\n    if (rtl && textRef.current) {\r\n      return (\r\n        task.x1 -\r\n        textRef.current.getBBox().width -\r\n        arrowIndent * +hasChild -\r\n        arrowIndent * 0.2\r\n      );\r\n    } else {\r\n      return task.x1 + width + arrowIndent * +hasChild + arrowIndent * 0.2;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <g\r\n      onKeyDown={e => {\r\n        switch (e.key) {\r\n          case \"Delete\": {\r\n            if (isDelete) onEventStart(\"delete\", task, e);\r\n            break;\r\n          }\r\n        }\r\n        e.stopPropagation();\r\n      }}\r\n      onMouseEnter={e => {\r\n        onEventStart(\"mouseenter\", task, e);\r\n      }}\r\n      onMouseLeave={e => {\r\n        onEventStart(\"mouseleave\", task, e);\r\n      }}\r\n      onDoubleClick={e => {\r\n        onEventStart(\"dblclick\", task, e);\r\n      }}\r\n      onClick={e => {\r\n        onEventStart(\"click\", task, e);\r\n      }}\r\n      onFocus={() => {\r\n        onEventStart(\"select\", task);\r\n      }}\r\n    >\r\n      {taskItem}\r\n      <text\r\n        x={getX()}\r\n        y={task.y + taskHeight * 0.5}\r\n        className={\r\n          isTextInside\r\n            ? style.barLabel\r\n            : style.barLabel && style.barLabelOutside\r\n        }\r\n        ref={textRef}\r\n      >\r\n        {task.name}\r\n      </text>\r\n    </g>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { EventOption } from \"../../types/public-types\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { Arrow } from \"../other/arrow\";\r\nimport { handleTaskBySVGMouseEvent } from \"../../helpers/bar-helper\";\r\nimport { isKeyboardEvent } from \"../../helpers/other-helper\";\r\nimport { TaskItem } from \"../task-item/task-item\";\r\nimport {\r\n  BarMoveAction,\r\n  GanttContentMoveAction,\r\n  GanttEvent,\r\n} from \"../../types/gantt-task-actions\";\r\n\r\nexport type TaskGanttContentProps = {\r\n  tasks: BarTask[];\r\n  dates: Date[];\r\n  ganttEvent: GanttEvent;\r\n  selectedTask: BarTask | undefined;\r\n  rowHeight: number;\r\n  columnWidth: number;\r\n  timeStep: number;\r\n  svg?: React.RefObject<SVGSVGElement>;\r\n  svgWidth: number;\r\n  taskHeight: number;\r\n  arrowColor: string;\r\n  arrowIndent: number;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n  rtl: boolean;\r\n  setGanttEvent: (value: GanttEvent) => void;\r\n  setFailedTask: (value: BarTask | null) => void;\r\n  setSelectedTask: (taskId: string) => void;\r\n} & EventOption;\r\n\r\nexport const TaskGanttContent: React.FC<TaskGanttContentProps> = ({\r\n  tasks,\r\n  dates,\r\n  ganttEvent,\r\n  selectedTask,\r\n  rowHeight,\r\n  columnWidth,\r\n  timeStep,\r\n  svg,\r\n  taskHeight,\r\n  arrowColor,\r\n  arrowIndent,\r\n  fontFamily,\r\n  fontSize,\r\n  rtl,\r\n  setGanttEvent,\r\n  setFailedTask,\r\n  setSelectedTask,\r\n  onDateChange,\r\n  onProgressChange,\r\n  onDoubleClick,\r\n  onClick,\r\n  onDelete,\r\n}) => {\r\n  const point = svg?.current?.createSVGPoint();\r\n  const [xStep, setXStep] = useState(0);\r\n  const [initEventX1Delta, setInitEventX1Delta] = useState(0);\r\n  const [isMoving, setIsMoving] = useState(false);\r\n\r\n  // create xStep\r\n  useEffect(() => {\r\n    const dateDelta =\r\n      dates[1].getTime() -\r\n      dates[0].getTime() -\r\n      dates[1].getTimezoneOffset() * 60 * 1000 +\r\n      dates[0].getTimezoneOffset() * 60 * 1000;\r\n    const newXStep = (timeStep * columnWidth) / dateDelta;\r\n    setXStep(newXStep);\r\n  }, [columnWidth, dates, timeStep]);\r\n\r\n  useEffect(() => {\r\n    const handleMouseMove = async (event: MouseEvent) => {\r\n      if (!ganttEvent.changedTask || !point || !svg?.current) return;\r\n      event.preventDefault();\r\n\r\n      point.x = event.clientX;\r\n      const cursor = point.matrixTransform(\r\n        svg?.current.getScreenCTM()?.inverse()\r\n      );\r\n\r\n      const { isChanged, changedTask } = handleTaskBySVGMouseEvent(\r\n        cursor.x,\r\n        ganttEvent.action as BarMoveAction,\r\n        ganttEvent.changedTask,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta,\r\n        rtl\r\n      );\r\n      if (isChanged) {\r\n        setGanttEvent({ action: ganttEvent.action, changedTask });\r\n      }\r\n    };\r\n\r\n    const handleMouseUp = async (event: MouseEvent) => {\r\n      const { action, originalSelectedTask, changedTask } = ganttEvent;\r\n      if (!changedTask || !point || !svg?.current || !originalSelectedTask)\r\n        return;\r\n      event.preventDefault();\r\n\r\n      point.x = event.clientX;\r\n      const cursor = point.matrixTransform(\r\n        svg?.current.getScreenCTM()?.inverse()\r\n      );\r\n      const { changedTask: newChangedTask } = handleTaskBySVGMouseEvent(\r\n        cursor.x,\r\n        action as BarMoveAction,\r\n        changedTask,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta,\r\n        rtl\r\n      );\r\n\r\n      const isNotLikeOriginal =\r\n        originalSelectedTask.start !== newChangedTask.start ||\r\n        originalSelectedTask.end !== newChangedTask.end ||\r\n        originalSelectedTask.progress !== newChangedTask.progress;\r\n\r\n      // remove listeners\r\n      svg.current.removeEventListener(\"mousemove\", handleMouseMove);\r\n      svg.current.removeEventListener(\"mouseup\", handleMouseUp);\r\n      setGanttEvent({ action: \"\" });\r\n      setIsMoving(false);\r\n\r\n      // custom operation start\r\n      let operationSuccess = true;\r\n      if (\r\n        (action === \"move\" || action === \"end\" || action === \"start\") &&\r\n        onDateChange &&\r\n        isNotLikeOriginal\r\n      ) {\r\n        try {\r\n          const result = await onDateChange(\r\n            newChangedTask,\r\n            newChangedTask.barChildren\r\n          );\r\n          if (result !== undefined) {\r\n            operationSuccess = result;\r\n          }\r\n        } catch (error) {\r\n          operationSuccess = false;\r\n        }\r\n      } else if (onProgressChange && isNotLikeOriginal) {\r\n        try {\r\n          const result = await onProgressChange(\r\n            newChangedTask,\r\n            newChangedTask.barChildren\r\n          );\r\n          if (result !== undefined) {\r\n            operationSuccess = result;\r\n          }\r\n        } catch (error) {\r\n          operationSuccess = false;\r\n        }\r\n      }\r\n\r\n      // If operation is failed - return old state\r\n      if (!operationSuccess) {\r\n        setFailedTask(originalSelectedTask);\r\n      }\r\n    };\r\n\r\n    if (\r\n      !isMoving &&\r\n      (ganttEvent.action === \"move\" ||\r\n        ganttEvent.action === \"end\" ||\r\n        ganttEvent.action === \"start\" ||\r\n        ganttEvent.action === \"progress\") &&\r\n      svg?.current\r\n    ) {\r\n      svg.current.addEventListener(\"mousemove\", handleMouseMove);\r\n      svg.current.addEventListener(\"mouseup\", handleMouseUp);\r\n      setIsMoving(true);\r\n    }\r\n  }, [\r\n    ganttEvent,\r\n    xStep,\r\n    initEventX1Delta,\r\n    onProgressChange,\r\n    timeStep,\r\n    onDateChange,\r\n    svg,\r\n    isMoving,\r\n    point,\r\n    rtl,\r\n    setFailedTask,\r\n    setGanttEvent,\r\n  ]);\r\n\r\n  /**\r\n   * Method is Start point of task change\r\n   */\r\n  const handleBarEventStart = async (\r\n    action: GanttContentMoveAction,\r\n    task: BarTask,\r\n    event?: React.MouseEvent | React.KeyboardEvent\r\n  ) => {\r\n    if (!event) {\r\n      if (action === \"select\") {\r\n        setSelectedTask(task.id);\r\n      }\r\n    }\r\n    // Keyboard events\r\n    else if (isKeyboardEvent(event)) {\r\n      if (action === \"delete\") {\r\n        if (onDelete) {\r\n          try {\r\n            const result = await onDelete(task);\r\n            if (result !== undefined && result) {\r\n              setGanttEvent({ action, changedTask: task });\r\n            }\r\n          } catch (error) {\r\n            console.error(\"Error on Delete. \" + error);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // Mouse Events\r\n    else if (action === \"mouseenter\") {\r\n      if (!ganttEvent.action) {\r\n        setGanttEvent({\r\n          action,\r\n          changedTask: task,\r\n          originalSelectedTask: task,\r\n        });\r\n      }\r\n    } else if (action === \"mouseleave\") {\r\n      if (ganttEvent.action === \"mouseenter\") {\r\n        setGanttEvent({ action: \"\" });\r\n      }\r\n    } else if (action === \"dblclick\") {\r\n      !!onDoubleClick && onDoubleClick(task);\r\n    } else if (action === \"click\") {\r\n      !!onClick && onClick(task);\r\n    }\r\n    // Change task event start\r\n    else if (action === \"move\") {\r\n      if (!svg?.current || !point) return;\r\n      point.x = event.clientX;\r\n      const cursor = point.matrixTransform(\r\n        svg.current.getScreenCTM()?.inverse()\r\n      );\r\n      setInitEventX1Delta(cursor.x - task.x1);\r\n      setGanttEvent({\r\n        action,\r\n        changedTask: task,\r\n        originalSelectedTask: task,\r\n      });\r\n    } else {\r\n      setGanttEvent({\r\n        action,\r\n        changedTask: task,\r\n        originalSelectedTask: task,\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <g className=\"content\">\r\n      <g className=\"arrows\" fill={arrowColor} stroke={arrowColor}>\r\n        {tasks.map(task => {\r\n          return task.barChildren.map(child => {\r\n            return (\r\n              <Arrow\r\n                key={`Arrow from ${task.id} to ${tasks[child.index].id}`}\r\n                taskFrom={task}\r\n                taskTo={tasks[child.index]}\r\n                rowHeight={rowHeight}\r\n                taskHeight={taskHeight}\r\n                arrowIndent={arrowIndent}\r\n                rtl={rtl}\r\n              />\r\n            );\r\n          });\r\n        })}\r\n      </g>\r\n      <g className=\"bar\" fontFamily={fontFamily} fontSize={fontSize}>\r\n        {Object.entries(\r\n          tasks.reduce((acc, task) => {\r\n            const key = task.name ?? \"\";\r\n            if (!acc[key]) acc[key] = [];\r\n            acc[key].push(task);\r\n            return acc;\r\n          }, {} as Record<string, BarTask[]>)\r\n        ).map(([groupName, groupTasks]) => (\r\n          <g key={groupName}>\r\n            {groupTasks.map((task) => (\r\n              <TaskItem\r\n                task={task}\r\n                arrowIndent={arrowIndent}\r\n                taskHeight={taskHeight}\r\n                isProgressChangeable={!!onProgressChange && !task.isDisabled}\r\n                isDateChangeable={!!onDateChange && !task.isDisabled}\r\n                isDelete={!task.isDisabled}\r\n                onEventStart={handleBarEventStart}\r\n                key={task.id}\r\n                isSelected={!!selectedTask && task.id === selectedTask.id}\r\n                rtl={rtl}\r\n              />\r\n            ))}\r\n          </g>\r\n        ))}\r\n      </g>\r\n    </g>\r\n  );\r\n};\r\n","import React, { useRef, useEffect } from \"react\";\r\nimport { GridProps, Grid } from \"../grid/grid\";\r\nimport { CalendarProps, Calendar } from \"../calendar/calendar\";\r\nimport { TaskGanttContentProps, TaskGanttContent } from \"./task-gantt-content\";\r\nimport styles from \"./gantt.module.css\";\r\n\r\nexport type TaskGanttProps = {\r\n  gridProps: GridProps;\r\n  calendarProps: CalendarProps;\r\n  barProps: TaskGanttContentProps;\r\n  ganttHeight: number;\r\n  scrollY: number;\r\n  scrollX: number;\r\n};\r\nexport const TaskGantt: React.FC<TaskGanttProps> = ({\r\n  gridProps,\r\n  calendarProps,\r\n  barProps,\r\n  ganttHeight,\r\n  scrollY,\r\n  scrollX,\r\n}) => {\r\n  const ganttSVGRef = useRef<SVGSVGElement>(null);\r\n  const horizontalContainerRef = useRef<HTMLDivElement>(null);\r\n  const verticalGanttContainerRef = useRef<HTMLDivElement>(null);\r\n  const newBarProps = { ...barProps, svg: ganttSVGRef };\r\n\r\n  useEffect(() => {\r\n    if (horizontalContainerRef.current) {\r\n      horizontalContainerRef.current.scrollTop = scrollY;\r\n    }\r\n  }, [scrollY]);\r\n\r\n  useEffect(() => {\r\n    if (verticalGanttContainerRef.current) {\r\n      verticalGanttContainerRef.current.scrollLeft = scrollX;\r\n    }\r\n  }, [scrollX]);\r\n\r\n  return (\r\n    <div\r\n      className={styles.ganttVerticalContainer}\r\n      ref={verticalGanttContainerRef}\r\n      dir=\"ltr\"\r\n    >\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={gridProps.svgWidth}\r\n        height={calendarProps.headerHeight}\r\n        fontFamily={barProps.fontFamily}\r\n      >\r\n        <Calendar {...calendarProps} />\r\n      </svg>\r\n      <div\r\n        ref={horizontalContainerRef}\r\n        className={styles.horizontalContainer}\r\n        style={\r\n          ganttHeight\r\n            ? { height: ganttHeight, width: gridProps.svgWidth }\r\n            : { width: gridProps.svgWidth }\r\n        }\r\n      >\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width={gridProps.svgWidth}\r\n          height={barProps.rowHeight * barProps.tasks.length}\r\n          fontFamily={barProps.fontFamily}\r\n          ref={ganttSVGRef}\r\n        >\r\n          <Grid {...gridProps} />\r\n          <TaskGanttContent {...newBarProps} />\r\n        </svg>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SyntheticEvent, useRef, useEffect } from \"react\";\r\nimport styles from \"./horizontal-scroll.module.css\";\r\n\r\nexport const HorizontalScroll: React.FC<{\r\n  scroll: number;\r\n  svgWidth: number;\r\n  taskListWidth: number;\r\n  rtl: boolean;\r\n  onScroll: (event: SyntheticEvent<HTMLDivElement>) => void;\r\n}> = ({ scroll, svgWidth, taskListWidth, rtl, onScroll }) => {\r\n  const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (scrollRef.current) {\r\n      scrollRef.current.scrollLeft = scroll;\r\n    }\r\n  }, [scroll]);\r\n\r\n  return (\r\n    <div\r\n      dir=\"ltr\"\r\n      style={{\r\n        margin: rtl\r\n          ? `0px ${taskListWidth}px 0px 0px`\r\n          : `0px 0px 0px ${taskListWidth}px`,\r\n      }}\r\n      className={styles.scrollWrapper}\r\n      onScroll={onScroll}\r\n      ref={scrollRef}\r\n    >\r\n      <div style={{ width: svgWidth }} className={styles.scroll} />\r\n    </div>\r\n  );\r\n};\r\n","import React, {\r\n  useState,\r\n  SyntheticEvent,\r\n  useRef,\r\n  useEffect,\r\n  useMemo,\r\n} from \"react\";\r\nimport { ViewMode, GanttProps, Task } from \"../../types/public-types\";\r\nimport { GridProps } from \"../grid/grid\";\r\nimport { ganttDateRange, seedDates } from \"../../helpers/date-helper\";\r\nimport { CalendarProps } from \"../calendar/calendar\";\r\nimport { TaskGanttContentProps } from \"./task-gantt-content\";\r\nimport { TaskListHeaderDefault } from \"../task-list/task-list-header\";\r\nimport { TaskListTableDefault } from \"../task-list/task-list-table\";\r\nimport { StandardTooltipContent, Tooltip } from \"../other/tooltip\";\r\nimport { VerticalScroll } from \"../other/vertical-scroll\";\r\nimport { TaskListProps, TaskList } from \"../task-list/task-list\";\r\nimport { TaskGantt } from \"./task-gantt\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { convertToBarTasks } from \"../../helpers/bar-helper\";\r\nimport { GanttEvent } from \"../../types/gantt-task-actions\";\r\nimport { DateSetup } from \"../../types/date-setup\";\r\nimport { HorizontalScroll } from \"../other/horizontal-scroll\";\r\nimport { removeHiddenTasks, sortTasks } from \"../../helpers/other-helper\";\r\nimport styles from \"./gantt.module.css\";\r\n\r\nexport const Gantt: React.FunctionComponent<GanttProps> = ({\r\n  tasks,\r\n  rowCountOverride,\r\n  headerHeight = 50,\r\n  columnWidth = 60,\r\n  listCellWidth = \"155px\",\r\n  rowHeight = 50,\r\n  ganttHeight = 0,\r\n  viewMode = ViewMode.Day,\r\n  preStepsCount = 1,\r\n  locale = \"en-GB\",\r\n  barFill = 60,\r\n  barCornerRadius = 3,\r\n  barProgressColor = \"#a3a3ff\",\r\n  barProgressSelectedColor = \"#8282f5\",\r\n  barBackgroundColor = \"#b8c2cc\",\r\n  barBackgroundSelectedColor = \"#aeb8c2\",\r\n  projectProgressColor = \"#7db59a\",\r\n  projectProgressSelectedColor = \"#59a985\",\r\n  projectBackgroundColor = \"#fac465\",\r\n  projectBackgroundSelectedColor = \"#f7bb53\",\r\n  milestoneBackgroundColor = \"#f1c453\",\r\n  milestoneBackgroundSelectedColor = \"#f29e4c\",\r\n  rtl = false,\r\n  handleWidth = 8,\r\n  timeStep = 300000,\r\n  arrowColor = \"grey\",\r\n  fontFamily = \"Arial, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue\",\r\n  fontSize = \"14px\",\r\n  arrowIndent = 20,\r\n  todayColor = \"rgba(252, 248, 227, 0.5)\",\r\n  viewDate,\r\n  TooltipContent = StandardTooltipContent,\r\n  TaskListHeader = TaskListHeaderDefault,\r\n  TaskListTable = TaskListTableDefault,\r\n  onDateChange,\r\n  onProgressChange,\r\n  onDoubleClick,\r\n  onClick,\r\n  onDelete,\r\n  onSelect,\r\n  onExpanderClick,\r\n}) => {\r\n  const wrapperRef = useRef<HTMLDivElement>(null);\r\n  const taskListRef = useRef<HTMLDivElement>(null);\r\n  const [dateSetup, setDateSetup] = useState<DateSetup>(() => {\r\n    const [startDate, endDate] = ganttDateRange(tasks, viewMode, preStepsCount);\r\n    return { viewMode, dates: seedDates(startDate, endDate, viewMode) };\r\n  });\r\n  const [currentViewDate, setCurrentViewDate] = useState<Date | undefined>(\r\n    undefined\r\n  );\r\n\r\n  const [taskListWidth, setTaskListWidth] = useState(0);\r\n  const [svgContainerWidth, setSvgContainerWidth] = useState(0);\r\n  const [barTasks, setBarTasks] = useState<BarTask[]>([]);\r\n  const [ganttEvent, setGanttEvent] = useState<GanttEvent>({\r\n    action: \"\",\r\n  });\r\n  const taskHeight = useMemo(\r\n    () => (rowHeight * barFill) / 100,\r\n    [rowHeight, barFill]\r\n  );\r\n  // const getRowCount = (tasks: { index: number }[]): number => {\r\n  //   if (!tasks.length) {\r\n  //     return 0;\r\n  //   }\r\n  //   let max = 0;\r\n  //   for (const t of tasks) {\r\n  //     if (t.index > max) {\r\n  //       max = t.index;\r\n  //     }\r\n  //   }\r\n  //   return max + 1;\r\n  // };\r\n\r\n  const [selectedTask, setSelectedTask] = useState<BarTask>();\r\n  const [failedTask, setFailedTask] = useState<BarTask | null>(null);\r\n\r\n  \r\n\r\n  const svgWidth = dateSetup.dates.length * columnWidth;\r\n  const baseRowCount = new Set(\r\n    barTasks.map(t => (t.name).trim().toLowerCase())\r\n  ).size;\r\n\r\n  const rowCount = rowCountOverride ?? baseRowCount;\r\n  const ganttFullHeight = rowCount * rowHeight;\r\n  // console.log(\"🔎 GANTT ROW DEBUG\", {\r\n  //   barTasksCount: barTasks.length,\r\n  //   names: barTasks.map(t => t.name),\r\n  //   normalizedNames: barTasks.map(t => (t.name ?? \"\").trim().toLowerCase()),\r\n  //   baseRowCount,\r\n  //   rowCount,\r\n  //   ganttFullHeight,\r\n  // });\r\n\r\n  const [svgContainerHeight, setSvgContainerHeight] = useState(ganttHeight);\r\n  const contentHeight = ganttFullHeight;\r\n  const containerHeight =\r\n    ganttHeight ||\r\n    (wrapperRef.current ? wrapperRef.current.clientHeight : svgContainerHeight - headerHeight);\r\n\r\n  const [scrollY, setScrollY] = useState(0);\r\n  const [scrollX, setScrollX] = useState(-1);\r\n  const [ignoreScrollEvent, setIgnoreScrollEvent] = useState(false);\r\n\r\n  // task change events\r\n  useEffect(() => {\r\n    let filteredTasks: Task[];\r\n    if (onExpanderClick) {\r\n      filteredTasks = removeHiddenTasks(tasks);\r\n    } else {\r\n      filteredTasks = tasks;\r\n    }\r\n    filteredTasks = filteredTasks.sort(sortTasks);\r\n    const [startDate, endDate] = ganttDateRange(\r\n      filteredTasks,\r\n      viewMode,\r\n      preStepsCount\r\n    );\r\n    let newDates = seedDates(startDate, endDate, viewMode);\r\n    if (rtl) {\r\n      newDates = newDates.reverse();\r\n      if (scrollX === -1) {\r\n        setScrollX(newDates.length * columnWidth);\r\n      }\r\n    }\r\n    setDateSetup({ dates: newDates, viewMode });\r\n    const rawBars = convertToBarTasks(\r\n      filteredTasks,\r\n      newDates,\r\n      columnWidth,\r\n      rowHeight,\r\n      taskHeight,\r\n      barCornerRadius,\r\n      handleWidth,\r\n      rtl,\r\n      barProgressColor,\r\n      barProgressSelectedColor,\r\n      barBackgroundColor,\r\n      barBackgroundSelectedColor,\r\n      projectProgressColor,\r\n      projectProgressSelectedColor,\r\n      projectBackgroundColor,\r\n      projectBackgroundSelectedColor,\r\n      milestoneBackgroundColor,\r\n      milestoneBackgroundSelectedColor\r\n    );\r\n\r\n    const rowMap = new Map<string, number>();\r\n    let nextRow = 0;\r\n\r\n    const groupedBars: BarTask[] = rawBars.map((bar) => {\r\n      const rowKey = (bar.name ?? \"\").trim().toLowerCase();\r\n\r\n      let rowIndex = rowMap.get(rowKey);\r\n      if (rowIndex === undefined) {\r\n        rowIndex = nextRow++;\r\n        rowMap.set(rowKey, rowIndex);\r\n      }\r\n\r\n      const newY = rowIndex * rowHeight + (rowHeight - taskHeight) / 2;\r\n      // console.log(\"BAR POSITION:\", { barName: bar.name, rowKey, rowIndex, newY });\r\n\r\n      return {\r\n        ...bar,\r\n        index: rowIndex,\r\n        y: newY,\r\n      };\r\n    });\r\n\r\n    setBarTasks(groupedBars);\r\n  }, [\r\n    tasks,\r\n    rowCountOverride,\r\n    viewMode,\r\n    preStepsCount,\r\n    rowHeight,\r\n    barCornerRadius,\r\n    columnWidth,\r\n    taskHeight,\r\n    handleWidth,\r\n    barProgressColor,\r\n    barProgressSelectedColor,\r\n    barBackgroundColor,\r\n    barBackgroundSelectedColor,\r\n    projectProgressColor,\r\n    projectProgressSelectedColor,\r\n    projectBackgroundColor,\r\n    projectBackgroundSelectedColor,\r\n    milestoneBackgroundColor,\r\n    milestoneBackgroundSelectedColor,\r\n    rtl,\r\n    scrollX,\r\n    onExpanderClick,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      viewMode === dateSetup.viewMode &&\r\n      ((viewDate && !currentViewDate) ||\r\n        (viewDate && currentViewDate?.valueOf() !== viewDate.valueOf()))\r\n    ) {\r\n      const dates = dateSetup.dates;\r\n      const index = dates.findIndex(\r\n        (d, i) =>\r\n          viewDate.valueOf() >= d.valueOf() &&\r\n          i + 1 !== dates.length &&\r\n          viewDate.valueOf() < dates[i + 1].valueOf()\r\n      );\r\n      if (index === -1) {\r\n        return;\r\n      }\r\n      setCurrentViewDate(viewDate);\r\n      setScrollX(columnWidth * index);\r\n    }\r\n  }, [\r\n    viewDate,\r\n    columnWidth,\r\n    dateSetup.dates,\r\n    dateSetup.viewMode,\r\n    viewMode,\r\n    currentViewDate,\r\n    setCurrentViewDate,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const { changedTask, action } = ganttEvent;\r\n    if (changedTask) {\r\n      if (action === \"delete\") {\r\n        setGanttEvent({ action: \"\" });\r\n        setBarTasks(barTasks.filter(t => t.id !== changedTask.id));\r\n      } else if (\r\n        action === \"move\" ||\r\n        action === \"end\" ||\r\n        action === \"start\" ||\r\n        action === \"progress\"\r\n      ) {\r\n        const prevStateTask = barTasks.find(t => t.id === changedTask.id);\r\n        if (\r\n          prevStateTask &&\r\n          (prevStateTask.start.getTime() !== changedTask.start.getTime() ||\r\n            prevStateTask.end.getTime() !== changedTask.end.getTime() ||\r\n            prevStateTask.progress !== changedTask.progress)\r\n        ) {\r\n          // actions for change\r\n          const newTaskList = barTasks.map(t =>\r\n            t.id === changedTask.id ? changedTask : t\r\n          );\r\n          setBarTasks(newTaskList);\r\n        }\r\n      }\r\n    }\r\n  }, [ganttEvent, barTasks]);\r\n\r\n  useEffect(() => {\r\n    if (failedTask) {\r\n      setBarTasks(barTasks.map(t => (t.id !== failedTask.id ? t : failedTask)));\r\n      setFailedTask(null);\r\n    }\r\n  }, [failedTask, barTasks]);\r\n\r\n  useEffect(() => {\r\n    if (!listCellWidth) {\r\n      setTaskListWidth(0);\r\n    }\r\n    if (taskListRef.current) {\r\n      setTaskListWidth(taskListRef.current.offsetWidth);\r\n    }\r\n  }, [taskListRef, listCellWidth]);\r\n\r\n  useEffect(() => {\r\n    if (wrapperRef.current) {\r\n      setSvgContainerWidth(wrapperRef.current.offsetWidth - taskListWidth);\r\n    }\r\n  }, [wrapperRef, taskListWidth]);\r\n\r\n  // console.log(\"wrapperRef size\", wrapperRef.current?.clientHeight)\r\n\r\n  useEffect(() => {\r\n    if (ganttHeight) {\r\n      setSvgContainerHeight(ganttHeight + headerHeight);\r\n    } else {\r\n      setSvgContainerHeight(rowCount * rowHeight + headerHeight);\r\n      // console.log(\"SETTING CONTAINER HEIGHT:\", rowCount * rowHeight + headerHeight);\r\n    }\r\n  }, [ganttHeight, headerHeight, rowHeight, rowCount]);\r\n\r\n\r\n  // scroll events\r\n  // useEffect(() => {\r\n  //   const handleWheel = (event: WheelEvent) => {\r\n  //     const fullHeight = contentHeight;\r\n  //     const visibleHeight = containerHeight - headerHeight;   // viewport minus top header\r\n  //     const maxScrollY = Math.max(0, fullHeight - visibleHeight);\r\n\r\n  //     console.log(\"wheel:\", { fullHeight, visibleHeight, maxScrollY, scrollY });\r\n\r\n  //     if (event.shiftKey || event.deltaX) {\r\n  //       const scrollMove = event.deltaX ? event.deltaX : event.deltaY;\r\n  //       let newScrollX = scrollX + scrollMove;\r\n  //       newScrollX = Math.max(0, Math.min(newScrollX, svgWidth));\r\n  //       setScrollX(newScrollX);\r\n  //       if (svgWidth > visibleHeight) {\r\n  //         event.preventDefault(); // prevent page horizontal scroll\r\n  //       }\r\n  //     } else {\r\n  //       let newScrollY = scrollY + event.deltaY;\r\n  //       newScrollY = Math.max(0, Math.min(newScrollY, maxScrollY));\r\n\r\n  //       // IMPORTANT: as long as we *can* scroll inside the Gantt,\r\n  //       // prevent the page from scrolling.\r\n  //       if (maxScrollY > 0) {\r\n  //         event.preventDefault();\r\n  //       }\r\n\r\n  //       if (newScrollY !== scrollY) {\r\n  //         setScrollY(newScrollY);\r\n  //       }\r\n  //     }\r\n\r\n  //     setIgnoreScrollEvent(true);\r\n  //   };\r\n\r\n  //   console.log(\"INIT: wrapperRef height =\", wrapperRef.current?.clientHeight);\r\n  //   console.log(\"INIT: attaching wheel listener at\", Date.now());\r\n  //   // subscribe if scroll is necessary\r\n  //   wrapperRef.current?.addEventListener(\"wheel\", handleWheel, {\r\n  //     passive: false,\r\n  //   });\r\n  //   return () => {\r\n  //     wrapperRef.current?.removeEventListener(\"wheel\", handleWheel);\r\n  //   };\r\n  // }, [\r\n  //   wrapperRef,\r\n  //   scrollY,\r\n  //   scrollX,\r\n  //   ganttHeight,\r\n  //   svgWidth,\r\n  //   rtl,\r\n  //   ganttFullHeight,\r\n  //   svgContainerHeight,\r\n  //   rowCountOverride\r\n  // ]);\r\n  useEffect(() => {\r\n    const el = wrapperRef.current;\r\n    if (!el) return;\r\n\r\n    const handleWheel = (event: WheelEvent) => {\r\n      if (!wrapperRef.current || !wrapperRef.current.contains(event.target as Node)) {\r\n        return;\r\n      }\r\n\r\n      const fullHeight = contentHeight;\r\n      const visibleHeight = (ganttHeight || wrapperRef.current.clientHeight) - headerHeight;\r\n      const maxScrollY = Math.max(0, fullHeight - visibleHeight);\r\n\r\n      if (event.shiftKey || Math.abs(event.deltaX) > Math.abs(event.deltaY)) {\r\n        const scrollMove = event.deltaX || event.deltaY;\r\n        setScrollX(prev =>\r\n          Math.max(0, Math.min(prev + scrollMove, svgWidth))\r\n        );\r\n      } else {\r\n        if (maxScrollY > 0) {\r\n          setScrollY(prev => {\r\n            const next = Math.max(0, Math.min(prev + event.deltaY, maxScrollY));\r\n            return next;\r\n          });\r\n        }\r\n      }\r\n\r\n      setIgnoreScrollEvent(true);\r\n    };\r\n\r\n    el.addEventListener(\"wheel\", handleWheel, { passive: true });\r\n    return () => el.removeEventListener(\"wheel\", handleWheel);\r\n  }, [ganttHeight, contentHeight, svgWidth, headerHeight]);\r\n\r\n\r\n  // const handleScrollY = (event: SyntheticEvent<HTMLDivElement>) => {\r\n  //   const fullHeight = contentHeight;\r\n  //   const visibleHeight = containerHeight - headerHeight;\r\n  //   const maxScrollY = Math.max(0, fullHeight - visibleHeight);\r\n\r\n  //   let newScrollY = event.currentTarget.scrollTop;\r\n  //   newScrollY = Math.max(0, Math.min(newScrollY, maxScrollY));\r\n\r\n  //   console.log(\"VerticalScroll:\", { fullHeight, visibleHeight, maxScrollY, newScrollY });\r\n\r\n  //   if (scrollY !== newScrollY && !ignoreScrollEvent) {\r\n  //     setScrollY(newScrollY);\r\n  //     setIgnoreScrollEvent(true);\r\n  //   } else {\r\n  //     setIgnoreScrollEvent(false);\r\n  //   }\r\n  // };\r\n  const handleScrollY = (event: SyntheticEvent<HTMLDivElement>) => {\r\n    const wrapper = wrapperRef.current;\r\n    const fullHeight = contentHeight;\r\n    const visibleHeight = (ganttHeight || (wrapper ? wrapper.clientHeight : 0)) - headerHeight;\r\n    const maxScrollY = Math.max(0, fullHeight - visibleHeight);\r\n\r\n    let newScrollY = event.currentTarget.scrollTop;\r\n    newScrollY = Math.max(0, Math.min(newScrollY, maxScrollY));\r\n\r\n    if (scrollY !== newScrollY && !ignoreScrollEvent) {\r\n      setScrollY(newScrollY);\r\n      setIgnoreScrollEvent(true);\r\n    } else {\r\n      setIgnoreScrollEvent(false);\r\n    }\r\n  };\r\n\r\n\r\n  const handleScrollX = (event: SyntheticEvent<HTMLDivElement>) => {\r\n    if (scrollX !== event.currentTarget.scrollLeft && !ignoreScrollEvent) {\r\n      setScrollX(event.currentTarget.scrollLeft);\r\n      setIgnoreScrollEvent(true);\r\n    } else {\r\n      setIgnoreScrollEvent(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handles arrow keys events and transform it to new scroll\r\n   */\r\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\r\n    event.preventDefault();\r\n    let newScrollY = scrollY;\r\n    let newScrollX = scrollX;\r\n    let isX = true;\r\n    switch (event.key) {\r\n      case \"Down\": // IE/Edge specific value\r\n      case \"ArrowDown\":\r\n        newScrollY += rowHeight;\r\n        isX = false;\r\n        break;\r\n      case \"Up\": // IE/Edge specific value\r\n      case \"ArrowUp\":\r\n        newScrollY -= rowHeight;\r\n        isX = false;\r\n        break;\r\n      case \"Left\":\r\n      case \"ArrowLeft\":\r\n        newScrollX -= columnWidth;\r\n        break;\r\n      case \"Right\": // IE/Edge specific value\r\n      case \"ArrowRight\":\r\n        newScrollX += columnWidth;\r\n        break;\r\n    }\r\n    if (isX) {\r\n      if (newScrollX < 0) {\r\n        newScrollX = 0;\r\n      } else if (newScrollX > svgWidth) {\r\n        newScrollX = svgWidth;\r\n      }\r\n      setScrollX(newScrollX);\r\n    } else {\r\n        const fullHeight = ganttFullHeight;\r\n        const visibleHeight = ganttHeight || (svgContainerHeight - headerHeight);\r\n        const maxScrollY = Math.max(0, fullHeight - visibleHeight);\r\n        // console.log(\"KEYDOWN SCROLL:\", { newScrollY, scrollY, maxScrollY });\r\n\r\n        if (newScrollY < 0) {\r\n          newScrollY = 0;\r\n        } else if (newScrollY > maxScrollY) {\r\n          newScrollY = maxScrollY;\r\n        }\r\n\r\n        setScrollY(newScrollY);\r\n      }\r\n    setIgnoreScrollEvent(true);\r\n  };\r\n\r\n  /**\r\n   * Task select event\r\n   */\r\n  const handleSelectedTask = (taskId: string) => {\r\n    const newSelectedTask = barTasks.find(t => t.id === taskId);\r\n    const oldSelectedTask = barTasks.find(\r\n      t => !!selectedTask && t.id === selectedTask.id\r\n    );\r\n    if (onSelect) {\r\n      if (oldSelectedTask) {\r\n        onSelect(oldSelectedTask, false);\r\n      }\r\n      if (newSelectedTask) {\r\n        onSelect(newSelectedTask, true);\r\n      }\r\n    }\r\n    setSelectedTask(newSelectedTask);\r\n  };\r\n  const handleExpanderClick = (task: Task) => {\r\n    if (onExpanderClick && task.hideChildren !== undefined) {\r\n      onExpanderClick({ ...task, hideChildren: !task.hideChildren });\r\n    }\r\n  };\r\n  const gridProps: GridProps = {\r\n    columnWidth,\r\n    svgWidth,\r\n    tasks: tasks,\r\n    rowHeight,\r\n    dates: dateSetup.dates,\r\n    todayColor,\r\n    rtl,\r\n  };\r\n  const calendarProps: CalendarProps = {\r\n    dateSetup,\r\n    locale,\r\n    viewMode,\r\n    headerHeight,\r\n    columnWidth,\r\n    fontFamily,\r\n    fontSize,\r\n    rtl,\r\n  };\r\n  const barProps: TaskGanttContentProps = {\r\n    tasks: barTasks,\r\n    dates: dateSetup.dates,\r\n    ganttEvent,\r\n    selectedTask,\r\n    rowHeight,\r\n    taskHeight,\r\n    columnWidth,\r\n    arrowColor,\r\n    timeStep,\r\n    fontFamily,\r\n    fontSize,\r\n    arrowIndent,\r\n    svgWidth,\r\n    rtl,\r\n    setGanttEvent,\r\n    setFailedTask,\r\n    setSelectedTask: handleSelectedTask,\r\n    onDateChange,\r\n    onProgressChange,\r\n    onDoubleClick,\r\n    onClick,\r\n    onDelete,\r\n  };\r\n\r\n  const tableProps: TaskListProps = {\r\n    rowHeight,\r\n    rowWidth: listCellWidth,\r\n    fontFamily,\r\n    fontSize,\r\n    tasks: barTasks,\r\n    locale,\r\n    headerHeight,\r\n    scrollY,\r\n    ganttHeight,\r\n    horizontalContainerClass: styles.horizontalContainer,\r\n    selectedTask,\r\n    taskListRef,\r\n    setSelectedTask: handleSelectedTask,\r\n    onExpanderClick: handleExpanderClick,\r\n    TaskListHeader,\r\n    TaskListTable,\r\n  };\r\n  return (\r\n    <div>\r\n      <div\r\n        className={styles.wrapper}\r\n        onKeyDown={handleKeyDown}\r\n        tabIndex={0}\r\n        ref={wrapperRef}\r\n      >\r\n        {listCellWidth && <TaskList {...tableProps} />}\r\n        <TaskGantt\r\n          gridProps={gridProps}\r\n          calendarProps={calendarProps}\r\n          barProps={barProps}\r\n          ganttHeight={ganttHeight}\r\n          scrollY={scrollY}\r\n          scrollX={scrollX}\r\n        />\r\n        {ganttEvent.changedTask && (\r\n          <Tooltip\r\n            arrowIndent={arrowIndent}\r\n            rowHeight={rowHeight}\r\n            svgContainerHeight={svgContainerHeight}\r\n            svgContainerWidth={svgContainerWidth}\r\n            fontFamily={fontFamily}\r\n            fontSize={fontSize}\r\n            scrollX={scrollX}\r\n            scrollY={scrollY}\r\n            task={ganttEvent.changedTask}\r\n            headerHeight={headerHeight}\r\n            taskListWidth={taskListWidth}\r\n            TooltipContent={TooltipContent}\r\n            rtl={rtl}\r\n            svgWidth={svgWidth}\r\n          />\r\n        )}\r\n        <VerticalScroll\r\n          ganttFullHeight={ganttFullHeight}\r\n          ganttHeight={containerHeight - headerHeight}\r\n          headerHeight={headerHeight}\r\n          scroll={scrollY}\r\n          onScroll={handleScrollY}\r\n          rtl={rtl}\r\n        />\r\n      </div>\r\n      <HorizontalScroll\r\n        svgWidth={svgWidth}\r\n        taskListWidth={taskListWidth}\r\n        scroll={scrollX}\r\n        rtl={rtl}\r\n        onScroll={handleScrollX}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport function debugNormalizedNames(barTasks: { name: string }[]) {\r\n  const normalized = barTasks.map(t => t.name.trim().toLowerCase());\r\n  const unique = Array.from(new Set(normalized));\r\n\r\n  console.log(\"RAW names:\", barTasks.map(t => t.name));\r\n  console.log(\"Normalized:\", normalized);\r\n  console.log(\"Unique normalized:\", unique);\r\n  console.log(\"Count:\", unique.length);\r\n\r\n  return unique;\r\n}\r\n"],"names":["ViewMode","intlDTCache","getCachedDateTimeFormat","locString","opts","key","JSON","stringify","dtf","Intl","DateTimeFormat","addToDate","date","quantity","scale","newDate","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","startOfDate","scores","shouldReset","_scale","maxScore","indexOf","ganttDateRange","tasks","viewMode","preStepsCount","newStartDate","start","newEndDate","task","end","Year","QuarterYear","Month","Week","getMonday","Day","QuarterDay","HalfDay","Hour","seedDates","startDate","endDate","currentDate","dates","push","getLocaleMonth","locale","bottomValue","month","format","replace","toLocaleUpperCase","getLocalDayOfWeek","weekday","day","getDay","diff","setDate","getWeekNumberISO8601","tmpDate","valueOf","dayNumber","firstThursday","setMonth","weekNumber","Math","ceil","toString","length","getDaysInMonth","year","TaskListHeaderDefault","headerHeight","fontFamily","fontSize","rowWidth","React","className","styles","ganttTable","style","ganttTable_Header","height","ganttTable_HeaderItem","minWidth","ganttTable_HeaderSeparator","marginTop","localeDateStringCache","toLocaleDateStringFactory","dateTimeOptions","getTime","lds","toLocaleDateString","TaskListTableDefault","rowHeight","onExpanderClick","useMemo","groups","reduce","acc","t","name","taskListWrapper","Object","entries","map","employeeTasks","main","expanderSymbol","hideChildren","taskListTableRow","taskListCell","maxWidth","title","taskListNameWrapper","taskListExpander","taskListEmptyExpander","onClick","min","max","Tooltip","rtl","svgContainerHeight","svgContainerWidth","scrollX","scrollY","arrowIndent","taskListWidth","TooltipContent","tooltipRef","useRef","useState","relatedY","setRelatedY","relatedX","setRelatedX","useEffect","current","tooltipHeight","offsetHeight","tooltipWidth","offsetWidth","newRelatedY","index","newRelatedX","x1","x2","tooltipLeftmostPoint","fullChartWidth","tooltipLowerPoint","ref","tooltipDetailsContainer","tooltipDetailsContainerHidden","left","top","StandardTooltipContent","tooltipDefaultContainer","tooltipDefaultContainerParagraph","progress","VerticalScroll","scroll","ganttHeight","ganttFullHeight","onScroll","scrollRef","scrollTop","console","log","scrollWrapper","width","TaskList","selectedTask","setSelectedTask","taskListRef","horizontalContainerClass","TaskListHeader","TaskListTable","horizontalContainerRef","headerProps","selectedTaskId","id","tableProps","GridBody","svgWidth","columnWidth","todayColor","groupNames","keys","rowCount","gridRows","rowLines","totalHeight","x","y1","y2","gridRowLine","y","i","gridRow","now","tickX","ticks","today","gridTick","isToday","fill","isTodayRTL","Grid","props","TopPartOfCalendar","value","x1Line","y1Line","y2Line","xText","yText","calendarTopTick","calendarTopText","Calendar","dateSetup","getCalendarValuesForYear","topValues","bottomValues","topDefaultHeight","calendarBottomText","topValue","getCalendarValuesForQuarterYear","quarter","floor","abs","getCalendarValuesForMonth","getCalendarValuesForWeek","weeksCount","getCalendarValuesForDay","getCalendarValuesForPartOfDay","hour","getCalendarValuesForHour","displayDate","topPosition","calendarHeader","Arrow","taskFrom","taskTo","taskHeight","path","trianglePoints","drownPathAndTriangleRTL","drownPathAndTriangle","strokeWidth","d","points","indexCompare","taskToEndPosition","taskFromEndPosition","taskFromHorizontalOffsetValue","taskToHorizontalOffsetValue","convertToBarTasks","barCornerRadius","handleWidth","barProgressColor","barProgressSelectedColor","barBackgroundColor","barBackgroundSelectedColor","projectProgressColor","projectProgressSelectedColor","projectBackgroundColor","projectBackgroundSelectedColor","milestoneBackgroundColor","milestoneBackgroundSelectedColor","grouped","values","barTasks","forEach","rowIndex","bar","convertToBarTask","dependencies","j","dependence","findIndex","barChildren","barTask","type","convertToMilestone","convertToBar","taskXCoordinateRTL","taskXCoordinate","typeInternal","progressWithByParams","progressWidth","progressX","taskYCoordinate","undefined","backgroundColor","backgroundSelectedColor","progressColor","progressSelectedColor","rotatedHeight","xDate","remainderMillis","percentOfInterval","taskX1","taskX2","progressByX","barWidth","progressPercent","round","progressByXRTL","getProgressPoint","taskY","point","join","startByX","xStep","steps","additionalXValue","newX","endByX","moveByX","newX1","newX2","dateByX","taskX","taskDate","timeStep","getTimezoneOffset","handleTaskBySVGMouseEvent","svgX","action","initEventX1Delta","result","handleTaskBySVGMouseEventForMilestone","handleTaskBySVGMouseEventForBar","changedTask","isChanged","newMoveX1","newMoveX2","isKeyboardEvent","event","removeHiddenTasks","groupedTasks","filter","groupedTask","children","getChildren","taskList","project","taskChildren","concat","sortTasks","taskA","taskB","orderA","displayOrder","Number","MAX_VALUE","orderB","BarDisplay","isSelected","onMouseDown","getProcessColor","getBarColor","ry","rx","barBackground","BarDateHandle","barHandle","BarProgressHandle","progressPoint","Bar","isProgressChangeable","isDateChangeable","onEventStart","handleHeight","barWrapper","tabIndex","e","BarSmall","Milestone","transform","milestoneWrapper","milestoneBackground","Project","barColor","processColor","projectWith","projectLeftTriangle","projectRightTriangle","projectWrapper","projectBackground","projectTop","TaskItem","isDelete","textRef","taskItem","setTaskItem","isTextInside","setIsTextInside","getBBox","getX","hasChild","onKeyDown","stopPropagation","onMouseEnter","onMouseLeave","onDoubleClick","onFocus","barLabel","barLabelOutside","TaskGanttContent","ganttEvent","svg","arrowColor","setGanttEvent","setFailedTask","onDateChange","onProgressChange","onDelete","createSVGPoint","setXStep","setInitEventX1Delta","isMoving","setIsMoving","dateDelta","newXStep","handleMouseMove","preventDefault","clientX","cursor","matrixTransform","getScreenCTM","inverse","handleMouseUp","operationSuccess","originalSelectedTask","newChangedTask","isNotLikeOriginal","removeEventListener","addEventListener","handleBarEventStart","error","stroke","child","groupName","groupTasks","isDisabled","TaskGantt","gridProps","calendarProps","barProps","ganttSVGRef","verticalGanttContainerRef","newBarProps","scrollLeft","ganttVerticalContainer","dir","xmlns","horizontalContainer","HorizontalScroll","margin","Gantt","rowCountOverride","listCellWidth","barFill","viewDate","onSelect","wrapperRef","setDateSetup","currentViewDate","setCurrentViewDate","setTaskListWidth","setSvgContainerWidth","setBarTasks","failedTask","baseRowCount","Set","trim","toLowerCase","size","setSvgContainerHeight","contentHeight","containerHeight","clientHeight","setScrollY","setScrollX","ignoreScrollEvent","setIgnoreScrollEvent","filteredTasks","sort","newDates","reverse","rawBars","rowMap","Map","nextRow","groupedBars","rowKey","get","set","newY","prevStateTask","find","newTaskList","el","handleWheel","contains","target","fullHeight","visibleHeight","maxScrollY","shiftKey","deltaX","deltaY","scrollMove","prev","next","passive","handleScrollY","wrapper","newScrollY","currentTarget","handleScrollX","handleKeyDown","newScrollX","isX","handleSelectedTask","taskId","newSelectedTask","oldSelectedTask","handleExpanderClick","debugNormalizedNames","normalized","unique","Array","from"],"mappings":"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"}